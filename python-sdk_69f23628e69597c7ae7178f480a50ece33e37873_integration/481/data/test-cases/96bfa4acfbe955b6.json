{"uid":"96bfa4acfbe955b6","name":"test_anyio_backend_import_issue[4]","fullName":"tests.integration.dbapi.sync.V2.test_queries#test_anyio_backend_import_issue","historyId":"f3095042f61b11396317cd5550e64c8a","time":{"start":1754402505470,"stop":1754402521515,"duration":16045},"status":"failed","statusMessage":"AssertionError: [HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.i...utput_format=JSON_Compact'\n  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\")]\nassert 2 == 0\n +  where 2 = len([HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.io/?database=integration_testing__1754402296837&engine=integration_testing__1754402296837&output_format=JSON_Compact'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\"), HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.io/?database=integration_testing__1754402296837&engine=integration_testing__1754402296837&output_format=JSON_Compact'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\")])","statusTrace":"engine_name = 'integration_testing__1754402296837'\ndatabase_name = 'integration_testing__1754402296837'\nauth = <firebolt.client.auth.client_credentials.ClientCredentials object at 0x7fa348a631c0>\naccount_name = 'automation', api_endpoint = 'api.staging.firebolt.io', _ = 4\n\n    @mark.parametrize(\"_\", range(5))\n    def test_anyio_backend_import_issue(\n        engine_name: str,\n        database_name: str,\n        auth: Auth,\n        account_name: str,\n        api_endpoint: str,\n        _: int,\n    ) -> None:\n        threads_cnt = 3\n        requests_cnt = 8\n        # collect threads exceptions in an array because they're ignored otherwise\n        exceptions = []\n    \n        def run_query(idx: int):\n            nonlocal auth, database_name, engine_name, account_name, api_endpoint\n            try:\n                with connect(\n                    auth=auth,\n                    database=database_name,\n                    account_name=account_name,\n                    engine_name=engine_name,\n                    api_endpoint=api_endpoint,\n                ) as c:\n                    cursor = c.cursor()\n                    cursor.execute(f\"select {idx}\")\n            except BaseException as e:\n                exceptions.append(e)\n    \n        def run_queries_parallel() -> None:\n            nonlocal requests_cnt\n            threads = [Thread(target=run_query, args=(i,)) for i in range(requests_cnt)]\n            [t.start() for t in threads]\n            [t.join() for t in threads]\n    \n        threads = [Thread(target=run_queries_parallel) for _ in range(threads_cnt)]\n    \n        [t.start() for t in threads]\n        [t.join() for t in threads]\n>       assert len(exceptions) == 0, exceptions\nE       AssertionError: [HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.i...utput_format=JSON_Compact'\nE         For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\")]\nE       assert 2 == 0\nE        +  where 2 = len([HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.io/?database=integration_testing__1754402296837&engine=integration_testing__1754402296837&output_format=JSON_Compact'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\"), HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.io/?database=integration_testing__1754402296837&engine=integration_testing__1754402296837&output_format=JSON_Compact'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\")])\n\ntests/integration/dbapi/sync/V2/test_queries.py:392: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"database_name","time":{"start":1754402403817,"stop":1754402403817,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"account_name","time":{"start":1754402403818,"stop":1754402403818,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_id","time":{"start":1754402403818,"stop":1754402403818,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_secret","time":{"start":1754402403818,"stop":1754402403819,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api_endpoint","time":{"start":1754402403818,"stop":1754402403818,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"auth","time":{"start":1754402403819,"stop":1754402403959,"duration":140},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"engine_name","time":{"start":1754402407822,"stop":1754402407822,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: [HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.i...utput_format=JSON_Compact'\n  For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\")]\nassert 2 == 0\n +  where 2 = len([HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.io/?database=integration_testing__1754402296837&engine=integration_testing__1754402296837&output_format=JSON_Compact'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\"), HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.io/?database=integration_testing__1754402296837&engine=integration_testing__1754402296837&output_format=JSON_Compact'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\")])","statusTrace":"engine_name = 'integration_testing__1754402296837'\ndatabase_name = 'integration_testing__1754402296837'\nauth = <firebolt.client.auth.client_credentials.ClientCredentials object at 0x7fa348a631c0>\naccount_name = 'automation', api_endpoint = 'api.staging.firebolt.io', _ = 4\n\n    @mark.parametrize(\"_\", range(5))\n    def test_anyio_backend_import_issue(\n        engine_name: str,\n        database_name: str,\n        auth: Auth,\n        account_name: str,\n        api_endpoint: str,\n        _: int,\n    ) -> None:\n        threads_cnt = 3\n        requests_cnt = 8\n        # collect threads exceptions in an array because they're ignored otherwise\n        exceptions = []\n    \n        def run_query(idx: int):\n            nonlocal auth, database_name, engine_name, account_name, api_endpoint\n            try:\n                with connect(\n                    auth=auth,\n                    database=database_name,\n                    account_name=account_name,\n                    engine_name=engine_name,\n                    api_endpoint=api_endpoint,\n                ) as c:\n                    cursor = c.cursor()\n                    cursor.execute(f\"select {idx}\")\n            except BaseException as e:\n                exceptions.append(e)\n    \n        def run_queries_parallel() -> None:\n            nonlocal requests_cnt\n            threads = [Thread(target=run_query, args=(i,)) for i in range(requests_cnt)]\n            [t.start() for t in threads]\n            [t.join() for t in threads]\n    \n        threads = [Thread(target=run_queries_parallel) for _ in range(threads_cnt)]\n    \n        [t.start() for t in threads]\n        [t.join() for t in threads]\n>       assert len(exceptions) == 0, exceptions\nE       AssertionError: [HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.i...utput_format=JSON_Compact'\nE         For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\")]\nE       assert 2 == 0\nE        +  where 2 = len([HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.io/?database=integration_testing__1754402296837&engine=integration_testing__1754402296837&output_format=JSON_Compact'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\"), HTTPStatusError(\"Server error '502 Bad Gateway' for url 'https://automation-firebolt.api.us-east-1.staging.firebolt.io/?database=integration_testing__1754402296837&engine=integration_testing__1754402296837&output_format=JSON_Compact'\\nFor more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502\")])\n\ntests/integration/dbapi/sync/V2/test_queries.py:392: AssertionError","steps":[],"attachments":[{"uid":"6da485d7ac6fa8b5","name":"log","source":"6da485d7ac6fa8b5.txt","type":"text/plain","size":272}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"parentSuite","value":"tests.integration.dbapi.sync.V2"},{"name":"suite","value":"test_queries"},{"name":"host","value":"pkrvmjbmru5nbw0"},{"name":"thread","value":"2466-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.dbapi.sync.V2.test_queries"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"_","value":"4"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"96bfa4acfbe955b6.json","parameterValues":["4"]}
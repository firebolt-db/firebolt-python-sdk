{"uid":"e37ccdf3bed7fc17","name":"test_long_query[remote]","fullName":"tests.integration.dbapi.sync.V2.test_queries#test_long_query","historyId":"c66814168378ce070fb5f3d193d9255d","time":{"start":1762425060291,"stop":1762425610234,"duration":549943},"description":"AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.","descriptionHtml":"<p>AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.</p>\n","status":"failed","statusMessage":"Failed: Timeout >550.0s","statusTrace":"connection = <firebolt.db.connection.Connection object at 0x7f7902c710d0>\nminimal_time = <function minimal_time.<locals>.setter at 0x7f79033b7280>\nlong_test_value = <function long_test_value.<locals>.long_test_value_with_default at 0x7f7903397b80>\n\n    @mark.slow\n    @mark.timeout(timeout=550)\n    def test_long_query(\n        connection: Connection,\n        minimal_time: Callable[[float], None],\n        long_test_value: Callable[[int], int],\n    ) -> None:\n        \"\"\"AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.\"\"\"\n    \n        minimal_time(350)\n    \n        with connection.cursor() as c:\n>           c.execute(\n                LONG_SELECT.format(long_value=long_test_value(LONG_SELECT_DEFAULT_V2))\n            )\n\ntests/integration/dbapi/sync/V2/test_queries.py:142: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/common/cursor/decorators.py:24: in inner\n    return func(self, *args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:360: in execute\n    self._do_execute(query, params_list, skip_parsing, timeout=timeout_seconds)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:218: in _do_execute\n    self._execute_plan(plan, timeout)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:242: in _execute_plan\n    self._execute_single_query(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:265: in _execute_single_query\n    resp = self._api_request(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:149: in _api_request\n    return self.connection._execute_query(req)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/connection.py:311: in _execute_query\n    return self._execute_query_impl(request)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/connection.py:290: in _execute_query_impl\n    response = self._client.send(request, stream=True)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_client.py:914: in send\n    response = self._send_handling_auth(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_client.py:942: in _send_handling_auth\n    response = self._send_handling_redirects(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/client/client.py:123: in _send_handling_redirects\n    return super()._send_handling_redirects(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_client.py:979: in _send_handling_redirects\n    response = self._send_single_request(request)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_client.py:1014: in _send_single_request\n    response = transport.handle_request(request)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_transports/default.py:250: in handle_request\n    resp = self._pool.handle_request(req)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request\n    raise exc from None\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request\n    response = connection.handle_request(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/connection.py:103: in handle_request\n    return self._connection.handle_request(request)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:136: in handle_request\n    raise exc\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:106: in handle_request\n    ) = self._receive_response_headers(**kwargs)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:177: in _receive_response_headers\n    event = self._receive_event(timeout=timeout)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:217: in _receive_event\n    data = self._network_stream.read(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_backends/sync.py:128: in read\n    return self._sock.recv(max_bytes)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/ssl.py:1262: in recv\n    return self.read(buflen)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>\nlen = 65536, buffer = None\n\n    def read(self, len=1024, buffer=None):\n        \"\"\"Read up to LEN bytes and return them.\n        Return zero-length string on EOF.\"\"\"\n    \n        self._checkClosed()\n        if self._sslobj is None:\n            raise ValueError(\"Read on closed or unwrapped SSL socket.\")\n        try:\n            if buffer is not None:\n                return self._sslobj.read(len, buffer)\n            else:\n>               return self._sslobj.read(len)\nE               Failed: Timeout >550.0s\n\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/ssl.py:1137: Failed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"insert_assert_add_to_builtins","time":{"start":1762425041197,"stop":1762425041197,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_session","time":{"start":1762425041198,"stop":1762425041201,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1762425041198,"stop":1762425041198,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_id","time":{"start":1762425041201,"stop":1762425041201,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"engine_name","time":{"start":1762425041201,"stop":1762425041201,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_secret","time":{"start":1762425041202,"stop":1762425041202,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"auth","time":{"start":1762425041202,"stop":1762425041385,"duration":183},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api_endpoint","time":{"start":1762425041386,"stop":1762425041386,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"account_name","time":{"start":1762425041386,"stop":1762425041386,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"core_auth","time":{"start":1762425042718,"stop":1762425042718,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"database_name","time":{"start":1762425042718,"stop":1762425042718,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"core_url","time":{"start":1762425042719,"stop":1762425042719,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_maybe_fail","time":{"start":1762425060233,"stop":1762425060233,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connection_factory","time":{"start":1762425060233,"stop":1762425060233,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connection","time":{"start":1762425060234,"stop":1762425060290,"duration":56},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"minimal_time","time":{"start":1762425060290,"stop":1762425060290,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"long_test_value","time":{"start":1762425060290,"stop":1762425060290,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.","status":"failed","statusMessage":"Failed: Timeout >550.0s","statusTrace":"connection = <firebolt.db.connection.Connection object at 0x7f7902c710d0>\nminimal_time = <function minimal_time.<locals>.setter at 0x7f79033b7280>\nlong_test_value = <function long_test_value.<locals>.long_test_value_with_default at 0x7f7903397b80>\n\n    @mark.slow\n    @mark.timeout(timeout=550)\n    def test_long_query(\n        connection: Connection,\n        minimal_time: Callable[[float], None],\n        long_test_value: Callable[[int], int],\n    ) -> None:\n        \"\"\"AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.\"\"\"\n    \n        minimal_time(350)\n    \n        with connection.cursor() as c:\n>           c.execute(\n                LONG_SELECT.format(long_value=long_test_value(LONG_SELECT_DEFAULT_V2))\n            )\n\ntests/integration/dbapi/sync/V2/test_queries.py:142: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/common/cursor/decorators.py:24: in inner\n    return func(self, *args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:360: in execute\n    self._do_execute(query, params_list, skip_parsing, timeout=timeout_seconds)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:218: in _do_execute\n    self._execute_plan(plan, timeout)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:242: in _execute_plan\n    self._execute_single_query(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:265: in _execute_single_query\n    resp = self._api_request(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:149: in _api_request\n    return self.connection._execute_query(req)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/connection.py:311: in _execute_query\n    return self._execute_query_impl(request)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/db/connection.py:290: in _execute_query_impl\n    response = self._client.send(request, stream=True)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_client.py:914: in send\n    response = self._send_handling_auth(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_client.py:942: in _send_handling_auth\n    response = self._send_handling_redirects(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/firebolt/client/client.py:123: in _send_handling_redirects\n    return super()._send_handling_redirects(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_client.py:979: in _send_handling_redirects\n    response = self._send_single_request(request)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_client.py:1014: in _send_single_request\n    response = transport.handle_request(request)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpx/_transports/default.py:250: in handle_request\n    resp = self._pool.handle_request(req)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request\n    raise exc from None\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request\n    response = connection.handle_request(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/connection.py:103: in handle_request\n    return self._connection.handle_request(request)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:136: in handle_request\n    raise exc\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:106: in handle_request\n    ) = self._receive_response_headers(**kwargs)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:177: in _receive_response_headers\n    event = self._receive_event(timeout=timeout)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:217: in _receive_event\n    data = self._network_stream.read(\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/site-packages/httpcore/_backends/sync.py:128: in read\n    return self._sock.recv(max_bytes)\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/ssl.py:1262: in recv\n    return self.read(buflen)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>\nlen = 65536, buffer = None\n\n    def read(self, len=1024, buffer=None):\n        \"\"\"Read up to LEN bytes and return them.\n        Return zero-length string on EOF.\"\"\"\n    \n        self._checkClosed()\n        if self._sslobj is None:\n            raise ValueError(\"Read on closed or unwrapped SSL socket.\")\n        try:\n            if buffer is not None:\n                return self._sslobj.read(len, buffer)\n            else:\n>               return self._sslobj.read(len)\nE               Failed: Timeout >550.0s\n\n/opt/hostedtoolcache/Python/3.9.24/x64/lib/python3.9/ssl.py:1137: Failed","steps":[],"attachments":[{"uid":"13813231818c0d97","name":"stderr","source":"13813231818c0d97.txt","type":"text/plain","size":888}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"connection::0","time":{"start":1762425610447,"stop":1762425610447,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"minimal_time::0","time":{"start":1762425610447,"stop":1762425610447,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_maybe_fail::0","time":{"start":1762425610448,"stop":1762425610448,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_session::0","time":{"start":1762425611864,"stop":1762425611864,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"slow"},{"name":"parentSuite","value":"tests.integration.dbapi.sync.V2"},{"name":"suite","value":"test_queries"},{"name":"host","value":"runnervmf2e7y"},{"name":"thread","value":"2475-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.dbapi.sync.V2.test_queries"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"connection_factory","value":"'remote'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["slow"]},"source":"e37ccdf3bed7fc17.json","parameterValues":["'remote'"]}
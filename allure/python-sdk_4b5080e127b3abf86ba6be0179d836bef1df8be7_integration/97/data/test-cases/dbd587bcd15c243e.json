{"uid":"dbd587bcd15c243e","name":"test_long_query[remote]","fullName":"tests.integration.dbapi.sync.V2.test_queries#test_long_query","historyId":"c66814168378ce070fb5f3d193d9255d","time":{"start":1755874603846,"stop":1755875153791,"duration":549945},"description":"AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.","descriptionHtml":"<p>AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.</p>\n","status":"failed","statusMessage":"Failed: Timeout >550.0s","statusTrace":"connection = <firebolt.db.connection.Connection object at 0x7f3cda381e40>\nminimal_time = <function minimal_time.<locals>.setter at 0x7f3cda38b8b0>\nlong_test_value = <function long_test_value.<locals>.long_test_value_with_default at 0x7f3cda38bdc0>\n\n    @mark.slow\n    @mark.timeout(timeout=550)\n    def test_long_query(\n        connection: Connection,\n        minimal_time: Callable[[float], None],\n        long_test_value: Callable[[int], int],\n    ) -> None:\n        \"\"\"AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.\"\"\"\n    \n        minimal_time(350)\n    \n        with connection.cursor() as c:\n>           c.execute(\n                LONG_SELECT.format(long_value=long_test_value(LONG_SELECT_DEFAULT_V2))\n            )\n\ntests/integration/dbapi/sync/V2/test_queries.py:117: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/common/cursor/decorators.py:24: in inner\n    return func(self, *args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:413: in execute\n    self._do_execute(query, params_list, skip_parsing, timeout=timeout_seconds)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:251: in _do_execute\n    self._execute_single_query(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:305: in _execute_single_query\n    self._handle_query_execution(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:329: in _handle_query_execution\n    resp = self._api_request(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:161: in _api_request\n    return self._client.send(req, stream=True)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_client.py:926: in send\n    response = self._send_handling_auth(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_client.py:954: in _send_handling_auth\n    response = self._send_handling_redirects(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/client/client.py:123: in _send_handling_redirects\n    return super()._send_handling_redirects(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_client.py:991: in _send_handling_redirects\n    response = self._send_single_request(request)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_client.py:1027: in _send_single_request\n    response = transport.handle_request(request)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_transports/default.py:236: in handle_request\n    resp = self._pool.handle_request(req)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request\n    raise exc from None\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request\n    response = connection.handle_request(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/connection.py:103: in handle_request\n    return self._connection.handle_request(request)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:136: in handle_request\n    raise exc\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:106: in handle_request\n    ) = self._receive_response_headers(**kwargs)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:177: in _receive_response_headers\n    event = self._receive_event(timeout=timeout)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:217: in _receive_event\n    data = self._network_stream.read(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_backends/sync.py:128: in read\n    return self._sock.recv(max_bytes)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/ssl.py:1260: in recv\n    return self.read(buflen)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>\nlen = 65536, buffer = None\n\n    def read(self, len=1024, buffer=None):\n        \"\"\"Read up to LEN bytes and return them.\n        Return zero-length string on EOF.\"\"\"\n    \n        self._checkClosed()\n        if self._sslobj is None:\n            raise ValueError(\"Read on closed or unwrapped SSL socket.\")\n        try:\n            if buffer is not None:\n                return self._sslobj.read(len, buffer)\n            else:\n>               return self._sslobj.read(len)\nE               Failed: Timeout >550.0s\n\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/ssl.py:1135: Failed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"database_name","time":{"start":1755874592492,"stop":1755874592492,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"account_name","time":{"start":1755874592492,"stop":1755874592492,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"service_id","time":{"start":1755874592492,"stop":1755874592493,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"auth","time":{"start":1755874592493,"stop":1755874592609,"duration":116},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"service_secret","time":{"start":1755874592493,"stop":1755874592493,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"api_endpoint","time":{"start":1755874592609,"stop":1755874592609,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"engine_name","time":{"start":1755874593182,"stop":1755874593182,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"core_auth","time":{"start":1755874593183,"stop":1755874593183,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"core_url","time":{"start":1755874593183,"stop":1755874593183,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"connection","time":{"start":1755874603792,"stop":1755874603844,"duration":52},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"long_test_value","time":{"start":1755874603845,"stop":1755874603845,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"minimal_time","time":{"start":1755874603845,"stop":1755874603845,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0}],"testStage":{"description":"AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.","status":"failed","statusMessage":"Failed: Timeout >550.0s","statusTrace":"connection = <firebolt.db.connection.Connection object at 0x7f3cda381e40>\nminimal_time = <function minimal_time.<locals>.setter at 0x7f3cda38b8b0>\nlong_test_value = <function long_test_value.<locals>.long_test_value_with_default at 0x7f3cda38bdc0>\n\n    @mark.slow\n    @mark.timeout(timeout=550)\n    def test_long_query(\n        connection: Connection,\n        minimal_time: Callable[[float], None],\n        long_test_value: Callable[[int], int],\n    ) -> None:\n        \"\"\"AWS ALB TCP timeout set to 350; make sure we handle the keepalive correctly.\"\"\"\n    \n        minimal_time(350)\n    \n        with connection.cursor() as c:\n>           c.execute(\n                LONG_SELECT.format(long_value=long_test_value(LONG_SELECT_DEFAULT_V2))\n            )\n\ntests/integration/dbapi/sync/V2/test_queries.py:117: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/common/cursor/decorators.py:24: in inner\n    return func(self, *args, **kwargs)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:413: in execute\n    self._do_execute(query, params_list, skip_parsing, timeout=timeout_seconds)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:251: in _do_execute\n    self._execute_single_query(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:305: in _execute_single_query\n    self._handle_query_execution(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:329: in _handle_query_execution\n    resp = self._api_request(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/db/cursor.py:161: in _api_request\n    return self._client.send(req, stream=True)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_client.py:926: in send\n    response = self._send_handling_auth(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_client.py:954: in _send_handling_auth\n    response = self._send_handling_redirects(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/firebolt/client/client.py:123: in _send_handling_redirects\n    return super()._send_handling_redirects(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_client.py:991: in _send_handling_redirects\n    response = self._send_single_request(request)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_client.py:1027: in _send_single_request\n    response = transport.handle_request(request)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpx/_transports/default.py:236: in handle_request\n    resp = self._pool.handle_request(req)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/connection_pool.py:256: in handle_request\n    raise exc from None\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/connection_pool.py:236: in handle_request\n    response = connection.handle_request(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/connection.py:103: in handle_request\n    return self._connection.handle_request(request)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:136: in handle_request\n    raise exc\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:106: in handle_request\n    ) = self._receive_response_headers(**kwargs)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:177: in _receive_response_headers\n    event = self._receive_event(timeout=timeout)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_sync/http11.py:217: in _receive_event\n    data = self._network_stream.read(\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/site-packages/httpcore/_backends/sync.py:128: in read\n    return self._sock.recv(max_bytes)\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/ssl.py:1260: in recv\n    return self.read(buflen)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>\nlen = 65536, buffer = None\n\n    def read(self, len=1024, buffer=None):\n        \"\"\"Read up to LEN bytes and return them.\n        Return zero-length string on EOF.\"\"\"\n    \n        self._checkClosed()\n        if self._sslobj is None:\n            raise ValueError(\"Read on closed or unwrapped SSL socket.\")\n        try:\n            if buffer is not None:\n                return self._sslobj.read(len, buffer)\n            else:\n>               return self._sslobj.read(len)\nE               Failed: Timeout >550.0s\n\n/opt/hostedtoolcache/Python/3.9.23/x64/lib/python3.9/ssl.py:1135: Failed","steps":[],"attachments":[{"uid":"1a7f41901fb13589","name":"stderr","source":"1a7f41901fb13589.txt","type":"text/plain","size":888}],"parameters":[],"hasContent":true,"attachmentStep":false,"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1},"afterStages":[{"name":"minimal_time::0","time":{"start":1755875153984,"stop":1755875153984,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0},{"name":"connection::0","time":{"start":1755875153984,"stop":1755875153984,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0}],"labels":[{"name":"tag","value":"slow"},{"name":"parentSuite","value":"tests.integration.dbapi.sync.V2"},{"name":"suite","value":"test_queries"},{"name":"host","value":"pkrvmqc4gcfdwos"},{"name":"thread","value":"2470-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.dbapi.sync.V2.test_queries"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"connection","value":"'remote'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["slow"]},"source":"dbd587bcd15c243e.json","parameterValues":["'remote'"]}
{"uid":"eae7029b8c7ee216","name":"test_executemany_bulk_insert_paramstyles[remote-fb_numeric-INSERT INTO \"test_tbl\" VALUES ($1, $2)-test_data0]","fullName":"tests.integration.dbapi.sync.V2.test_queries#test_executemany_bulk_insert_paramstyles","historyId":"0663a55cb7135e99a45547f16eebf663","time":{"start":1761039491979,"stop":1761039492271,"duration":292},"description":"executemany with bulk_insert=True works correctly for both paramstyles.","descriptionHtml":"<p>executemany with bulk_insert=True works correctly for both paramstyles.</p>\n","status":"failed","statusMessage":"AssertionError: assert 6 == 3\n +  where 6 = len([[1, 'alice'], [2, 'bob'], [3, 'charlie'], [4, 'david'], [5, 'eve'], [6, 'frank']])\n +  and   3 = len([(1, 'alice'), (2, 'bob'), (3, 'charlie')])","statusTrace":"connection = <firebolt.db.connection.Connection object at 0x7f38f182e200>\nparamstyle = 'fb_numeric', query = 'INSERT INTO \"test_tbl\" VALUES ($1, $2)'\ntest_data = [(1, 'alice'), (2, 'bob'), (3, 'charlie')]\ncreate_drop_test_table_setup_teardown = <firebolt.db.cursor.CursorV2 object at 0x7f38f186cca0>\n\n    @mark.parametrize(\n        \"paramstyle,query,test_data\",\n        [\n            (\n                \"fb_numeric\",\n                'INSERT INTO \"test_tbl\" VALUES ($1, $2)',\n                [(1, \"alice\"), (2, \"bob\"), (3, \"charlie\")],\n            ),\n            (\n                \"qmark\",\n                'INSERT INTO \"test_tbl\" VALUES (?, ?)',\n                [(4, \"david\"), (5, \"eve\"), (6, \"frank\")],\n            ),\n        ],\n    )\n    def test_executemany_bulk_insert_paramstyles(\n        connection: Connection,\n        paramstyle: str,\n        query: str,\n        test_data: List[Tuple],\n        create_drop_test_table_setup_teardown: Callable,\n    ) -> None:\n        \"\"\"executemany with bulk_insert=True works correctly for both paramstyles.\"\"\"\n        # Set the paramstyle for this test\n        original_paramstyle = firebolt.db.paramstyle\n        firebolt.db.paramstyle = paramstyle\n        # Generate a unique label for this test execution\n        unique_label = f\"test_bulk_insert_{paramstyle}_{randint(100000, 999999)}\"\n        table_name = \"test_tbl\"\n    \n        try:\n            c = connection.cursor()\n    \n            # Can't do this for fb_numeric yet - FIR-49970\n            if paramstyle != \"fb_numeric\":\n                c.execute(f\"SET query_label = '{unique_label}'\")\n    \n            # Execute bulk insert\n            c.executemany(\n                query,\n                test_data,\n                bulk_insert=True,\n            )\n    \n            # Verify the data was inserted correctly\n            c.execute(f'SELECT * FROM \"{table_name}\" ORDER BY id')\n            data = c.fetchall()\n>           assert len(data) == len(test_data)\nE           AssertionError: assert 6 == 3\nE            +  where 6 = len([[1, 'alice'], [2, 'bob'], [3, 'charlie'], [4, 'david'], [5, 'eve'], [6, 'frank']])\nE            +  and   3 = len([(1, 'alice'), (2, 'bob'), (3, 'charlie')])\n\ntests/integration/dbapi/sync/V2/test_queries.py:335: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"pytestconfig","time":{"start":1761039479575,"stop":1761039479575,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_add_to_builtins","time":{"start":1761039479575,"stop":1761039479575,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"database_name","time":{"start":1761039479576,"stop":1761039479576,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_id","time":{"start":1761039479576,"stop":1761039479577,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_session","time":{"start":1761039479576,"stop":1761039479576,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"account_name","time":{"start":1761039479576,"stop":1761039479576,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"auth","time":{"start":1761039479577,"stop":1761039479832,"duration":255},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_secret","time":{"start":1761039479577,"stop":1761039479577,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api_endpoint","time":{"start":1761039479835,"stop":1761039479835,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"engine_name","time":{"start":1761039480355,"stop":1761039480355,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"core_auth","time":{"start":1761039480355,"stop":1761039480356,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"core_url","time":{"start":1761039480356,"stop":1761039480356,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_maybe_fail","time":{"start":1761039491865,"stop":1761039491865,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connection","time":{"start":1761039491865,"stop":1761039491919,"duration":54},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"create_drop_test_table_setup_teardown","time":{"start":1761039491919,"stop":1761039491978,"duration":59},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"create_drop_test_table_setup_teardown::0","time":{"start":1761039492286,"stop":1761039492470,"duration":184},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connection::0","time":{"start":1761039492471,"stop":1761039492471,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_maybe_fail::0","time":{"start":1761039492472,"stop":1761039492472,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"insert_assert_session::0","time":{"start":1761039598327,"stop":1761039598327,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.integration.dbapi.sync.V2"},{"name":"suite","value":"test_queries"},{"name":"host","value":"runnervmwhb2z"},{"name":"thread","value":"2493-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.dbapi.sync.V2.test_queries"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"connection","value":"'remote'"},{"name":"paramstyle","value":"'fb_numeric'"},{"name":"query","value":"'INSERT INTO \"test_tbl\" VALUES ($1, $2)'"},{"name":"test_data","value":"[(1, 'alice'), (2, 'bob'), (3, 'charlie')]"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"eae7029b8c7ee216.json","parameterValues":["'remote'","'fb_numeric'","'INSERT INTO \"test_tbl\" VALUES ($1, $2)'","[(1, 'alice'), (2, 'bob'), (3, 'charlie')]"]}
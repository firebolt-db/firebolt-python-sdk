{"uid":"d52532cad796d384","name":"test_select","fullName":"tests.integration.dbapi.sync.V2.test_queries#test_select","historyId":"3b3d23821752925431ccf78989e328ce","time":{"start":1733141049898,"stop":1733141050011,"duration":113},"description":"Select handles all data types properly.","descriptionHtml":"<p>Select handles all data types properly.</p>\n","status":"broken","statusMessage":"firebolt.utils.exception.OperationalError: query param not allowed: enable_geography","statusTrace":"connection = <firebolt.db.connection.Connection object at 0x7fc4c938fb30>\nall_types_query = 'select 1 as uint8, -1 as int_8, 257 as uint16, -257 as int16, 80000 as uint32, -80000 as int32, 30000000000 as uint64...ecimal(38,30)) as \"decimal\", null as \"nullable\", \\'abc123\\'::bytea as \"bytea\",\\'POINT(1 1)\\'::geography as \"geography\"'\nall_types_query_description = [Column(name='uint8', type_code=<class 'int'>, display_size=None, internal_size=None, precision=None, scale=None, null...int32', type_code=<class 'int'>, display_size=None, internal_size=None, precision=None, scale=None, null_ok=None), ...]\nall_types_query_response = [[1, -1, 257, -257, 80000, -80000, ...]]\ntimezone_name = 'Asia/Calcutta'\n\n    def test_select(\n        connection: Connection,\n        all_types_query: str,\n        all_types_query_description: List[Column],\n        all_types_query_response: List[ColType],\n        timezone_name: str,\n    ) -> None:\n        \"\"\"Select handles all data types properly.\"\"\"\n        with connection.cursor() as c:\n            # For timestamptz test\n            assert (\n                c.execute(f\"SET time_zone={timezone_name}\") == -1\n            ), \"Invalid set statment row count\"\n>           c.execute(\"SET enable_geography=true\")\n\ntests/integration/dbapi/sync/V2/test_queries.py:57: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/firebolt/common/base_cursor.py:122: in inner\n    return func(self, *args, **kwargs)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/firebolt/db/cursor.py:229: in execute\n    self._do_execute(query, params_list, skip_parsing)\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/firebolt/db/cursor.py:173: in _do_execute\n    self._validate_set_parameter(query)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <firebolt.db.cursor.CursorV2 object at 0x7fc4c93545c0>\nparameter = SetParameter(name='enable_geography', value='true')\n\n    def _validate_set_parameter(self, parameter: SetParameter) -> None:\n        \"\"\"Validate parameter by executing simple query with it.\"\"\"\n        _raise_if_internal_set_parameter(parameter)\n        resp = self._api_request(\"select 1\", {parameter.name: parameter.value})\n        # Handle invalid set parameter\n        if resp.status_code == codes.BAD_REQUEST:\n>           raise OperationalError(resp.text)\nE           firebolt.utils.exception.OperationalError: query param not allowed: enable_geography\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/firebolt/db/cursor.py:127: OperationalError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"engine_name","time":{"start":1733141044900,"stop":1733141044900,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_id","time":{"start":1733141044900,"stop":1733141044900,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_secret","time":{"start":1733141044900,"stop":1733141044900,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"auth","time":{"start":1733141044901,"stop":1733141045124,"duration":223},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"account_name","time":{"start":1733141045124,"stop":1733141045124,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api_endpoint","time":{"start":1733141045125,"stop":1733141045125,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"database_name","time":{"start":1733141046362,"stop":1733141046362,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connection","time":{"start":1733141049390,"stop":1733141049897,"duration":507},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"all_types_query_description","time":{"start":1733141049897,"stop":1733141049897,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"all_types_query_response","time":{"start":1733141049897,"stop":1733141049897,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"all_types_query","time":{"start":1733141049897,"stop":1733141049897,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"timezone_offset_seconds","time":{"start":1733141049897,"stop":1733141049897,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"timezone_name","time":{"start":1733141049898,"stop":1733141049898,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"connection::0","time":{"start":1733141050037,"stop":1733141050037,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.integration.dbapi.sync.V2"},{"name":"suite","value":"test_queries"},{"name":"host","value":"fv-az883-496"},{"name":"thread","value":"2132-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.dbapi.sync.V2.test_queries"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"d52532cad796d384.json","parameterValues":[]}
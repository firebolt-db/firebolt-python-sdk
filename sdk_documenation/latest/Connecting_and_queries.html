<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Connecting and running queries &mdash; firebolt-python-sdk  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Managing engines and databases" href="Managing_resources.html" />
    <link rel="prev" title="Firebolt-python-sdk" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            firebolt-python-sdk
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Connecting and querying</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-a-connection">Setting up a connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#synchronous-command-and-query-examples">Synchronous command and query examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#inserting-and-selecting-data">Inserting and selecting data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetching-query-results">Fetching query results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetching-query-result-information">Fetching query result information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#executing-parameterized-queries">Executing parameterized queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-session-parameters">Setting session parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#executing-multiple-statement-queries">Executing multiple-statement queries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#asynchronous-query-execution">Asynchronous query execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#simple-asynchronous-example">Simple asynchronous example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-multiple-queries-in-parallel">Running multiple queries in parallel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limiting-number-of-conccurent-queries">Limiting number of conccurent queries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#thread-safety">Thread safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-date-and-datetime-values">Using DATE and DATETIME values</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Managing_resources.html">Managing resources</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="firebolt.async_db.html">Async DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="firebolt.client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="firebolt.common.html">Common</a></li>
<li class="toctree-l1"><a class="reference internal" href="firebolt.db.html">DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="firebolt.model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="firebolt.service.html">Service</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">firebolt-python-sdk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Connecting and running queries</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Connecting_and_queries.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="connecting-and-running-queries">
<h1>Connecting and running queries<a class="headerlink" href="#connecting-and-running-queries" title="Link to this heading"></a></h1>
<p>This topic provides a walkthrough and examples for how to use the Firebolt Python SDK to
connect to Firebolt resources to run commands and query data.</p>
<section id="setting-up-a-connection">
<h2>Setting up a connection<a class="headerlink" href="#setting-up-a-connection" title="Link to this heading"></a></h2>
<p>To connect to a Firebolt database to run queries or command, you must provide your account
credentials through a connection request.</p>
<p>To get started, follow the steps below:</p>
<p><strong>1. Import modules</strong></p>
<blockquote>
<div><p>The Firebolt Python SDK requires you to import the following modules before making
any command or query requests to your Firebolt database.</p>
</div></blockquote>
<blockquote id="required-connection-imports">
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">firebolt.db</span> <span class="kn">import</span> <span class="n">connect</span>
<span class="kn">from</span> <span class="nn">firebolt.client.auth</span> <span class="kn">import</span> <span class="n">ClientCredentials</span>
</pre></div>
</div>
</div></blockquote>
<p id="connecting-with-credentials-example"><strong>2. Connect to your database and engine</strong></p>
<blockquote>
<div><p>Your account information can be provided as parameters in a <code class="docutils literal notranslate"><span class="pre">connection()</span></code> function.</p>
<p>A connection requires the following parameters:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">auth</span></code></p></td>
<td><p>Auth object, containing your credentials. See <a class="reference internal" href="firebolt.client.html#module-firebolt.client.auth.client_credentials.ClientCredentials"><span class="std std-ref">Auth</span></a> for more details.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">account_name</span></code></p></td>
<td><p>The name of the account you’re using to connect to Firebolt. Must be specified in order to authenticate.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">database</span></code></p></td>
<td><p>Optional. The name of the database you would like to connect to.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">engine_name</span></code></p></td>
<td><p>Optional. The name of the engine to use for SQL queries.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you specify <code class="docutils literal notranslate"><span class="pre">engine_name</span></code> but not the <code class="docutils literal notranslate"><span class="pre">database</span></code> Python SDK will automatically resolve the database for you behind the scenes.</p>
<p>If an <code class="docutils literal notranslate"><span class="pre">engine_name</span></code> is not specified the SDK will not be bound to any engine. In this case, if also no <code class="docutils literal notranslate"><span class="pre">database</span></code> is specified
you can still connect, but queries are limited to database and engine management queries e.g. <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">DATABASE</span></code>, <code class="docutils literal notranslate"><span class="pre">START</span> <span class="pre">ENGINE</span></code>, etc.
To interact with tables in a database you have to provide the <code class="docutils literal notranslate"><span class="pre">database</span></code> parameter when connecting with no engine.</p>
</div>
<p>This information can be provided in multiple ways.</p>
<blockquote>
<div><ul>
<li><p><strong>Set credentials manually</strong></p>
<blockquote>
<div><p>You can manually include your account information in a connection object in
your code for any queries you want to request.</p>
<p>Replace the values in the example code below with your Firebolt account
credentials as appropriate.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span> <span class="o">=</span> <span class="s2">&quot;your_service_account_id&quot;</span>
<span class="n">secret</span> <span class="o">=</span> <span class="s2">&quot;your_service_account_secret&quot;</span>
<span class="n">engine_name</span> <span class="o">=</span> <span class="s2">&quot;your_engine&quot;</span>
<span class="n">database_name</span> <span class="o">=</span> <span class="s2">&quot;your_database&quot;</span>
<span class="n">account_name</span> <span class="o">=</span> <span class="s2">&quot;your_account&quot;</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span>
        <span class="n">engine_name</span><span class="o">=</span><span class="n">engine_name</span><span class="p">,</span>
        <span class="n">database</span><span class="o">=</span><span class="n">database_name</span><span class="p">,</span>
        <span class="n">account_name</span><span class="o">=</span><span class="n">account_name</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">ClientCredentials</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">secret</span><span class="p">),</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p><strong>Use an .env file</strong></p>
<blockquote>
<div><p>Consolidating all of your Firebolt credentials into a <code class="docutils literal notranslate"><span class="pre">.env</span></code> file can help
protect sensitive information from exposure. Create an <code class="docutils literal notranslate"><span class="pre">.env</span></code> file with the
following key-value pairs, and replace the values with your information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FIREBOLT_CLIENT_ID</span><span class="o">=</span><span class="s2">&quot;your_service_account_id&quot;</span>
<span class="n">FIREBOLT_CLIENT_SECRET</span><span class="o">=</span><span class="s2">&quot;your_service_account_secret&quot;</span>
<span class="n">FIREBOLT_ENGINE</span><span class="o">=</span><span class="s2">&quot;your_engine&quot;</span>
<span class="n">FIREBOLT_DB</span><span class="o">=</span><span class="s2">&quot;your_database&quot;</span>
<span class="n">FIREBOLT_ACCOUNT</span><span class="o">=</span><span class="s2">&quot;your_account&quot;</span>
</pre></div>
</div>
<p>Be sure to place this <code class="docutils literal notranslate"><span class="pre">.env</span></code> file into your root directory.</p>
<p>Your connection script can load these environmental variables from the <code class="docutils literal notranslate"><span class="pre">.env</span></code>
file by using the <a class="reference external" href="https://pypi.org/project/python-dotenv/">python-dotenv</a>
package. Note that the example below imports the <code class="docutils literal notranslate"><span class="pre">os</span></code> and <code class="docutils literal notranslate"><span class="pre">dotenv</span></code> modules
in order to load the environmental variables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">()</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span>
    <span class="n">auth</span><span class="o">=</span><span class="n">ClientCredentials</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;FIREBOLT_CLIENT_ID&quot;</span><span class="p">),</span>
        <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;FIREBOLT_CLIENT_SECRET&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">engine_name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;FIREBOLT_ENGINE&#39;</span><span class="p">),</span>
    <span class="n">database</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;FIREBOLT_DB&#39;</span><span class="p">),</span>
    <span class="n">account_name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;FIREBOLT_ACCOUNT&#39;</span><span class="p">),</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div></blockquote>
<p><strong>3. Token management/caching</strong></p>
<blockquote>
<div><p>Firebolt allows access by using authentication and refresh tokens.  In order to authenticate,
the SDK issues an http login request to the Firebolt API, providing username and password.
The API returns an authentication token and refresh token.   Authentication tokens are valid
for 12 hours, and can be refreshed using the refresh token.  The SDK uses the authentication
token for all subsequent requests, and includes logic for refreshing the token if it is reported as expired.</p>
<p>Because a typical script that uses the SDK usually runs for less than a minute and then is closed,
the token is lost because it’s only stored in a process memory.  To avoid that, the SDK by default does token caching.
Token caching is designed to preserve the token in filesystem to later reuse it for requests and save time on
authentication api request. It also helps for workflows that use the SDL in parallel or in sequential scripts
on the same machine, as only a single authentication request is performed.  The caching works by preserving the
token value and it’s expiration timestamp in filesystem, in user data directory. On the authentication, the SDK
first tries to find a token cache file and, if it exists, checks that token is not yet expired. If the token
is valid, it’s used for further authorization. The token value itself is encrypted with PBKDF2 algorithm,
the encryption key is a combination of user credentials.</p>
<p>Token caching can be disabled if desired.  If the server the SDK is running on has a read only
filesystem (when using AWS Lambda, for example), then the SDK will not be able to store the token.
The caching is disabled by adding <code class="docutils literal notranslate"><span class="pre">use_token_cache=False</span></code> to the auth object.  From the examples above,
it would look like: <code class="docutils literal notranslate"><span class="pre">auth=UsernamePassword(username,</span> <span class="pre">password,use_token_cache=False),</span></code></p>
</div></blockquote>
<p><strong>4. Execute commands using the cursor</strong></p>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">cursor</span></code> object can be used to send queries and commands to your Firebolt
database and engine. See below for examples of functions using the <code class="docutils literal notranslate"><span class="pre">cursor</span></code> object.</p>
</div></blockquote>
</section>
<section id="synchronous-command-and-query-examples">
<h2>Synchronous command and query examples<a class="headerlink" href="#synchronous-command-and-query-examples" title="Link to this heading"></a></h2>
<p>This section includes Python examples of various SQL commands and queries.</p>
<section id="inserting-and-selecting-data">
<h3>Inserting and selecting data<a class="headerlink" href="#inserting-and-selecting-data" title="Link to this heading"></a></h3>
<p id="basic-execute-example">The example below uses <code class="docutils literal notranslate"><span class="pre">cursor</span></code> to create a new table called <code class="docutils literal notranslate"><span class="pre">test_table</span></code>, insert
rows into it, and then select the table’s contents.</p>
<p>The engine attached to your specified database must be started before executing any
queries. For help, see <a class="reference internal" href="Managing_resources.html#starting-an-engine"><span class="std std-ref">Starting an engine</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CREATE FACT TABLE IF NOT EXISTS test_table (</span>
<span class="sd">        id INT,</span>
<span class="sd">        name TEXT</span>
<span class="sd">    )</span>
<span class="sd">    PRIMARY INDEX id;</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    INSERT INTO test_table VALUES</span>
<span class="sd">    (1, &#39;hello&#39;),</span>
<span class="sd">    (2, &#39;world&#39;),</span>
<span class="sd">    (3, &#39;!&#39;);</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">)</span>

<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM test_table;&quot;</span><span class="p">)</span>

<span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For reference documentation on <code class="docutils literal notranslate"><span class="pre">cursor</span></code> functions, see <a class="reference internal" href="firebolt.db.html#module-firebolt.db.cursor"><span class="std std-ref">cursor</span></a>.</p>
</div>
</section>
<section id="fetching-query-results">
<h3>Fetching query results<a class="headerlink" href="#fetching-query-results" title="Link to this heading"></a></h3>
<p>After running a query, you can fetch the results using a <code class="docutils literal notranslate"><span class="pre">cursor</span></code> object. The examples
below use the data queried from <code class="docutils literal notranslate"><span class="pre">test_table</span></code> created in the
<a class="reference internal" href="#inserting-and-selecting-data"><span class="std std-ref">Inserting and selecting data</span></a>.</p>
<blockquote id="fetch-example">
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">())</span>
</pre></div>
</div>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">'world']</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">[[1,</span> <span class="pre">'hello'],</span> <span class="pre">[3,</span> <span class="pre">'!']]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">[[2,</span> <span class="pre">'world'],</span> <span class="pre">[1,</span> <span class="pre">'hello'],</span> <span class="pre">[3,</span> <span class="pre">'!']]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</pre></div>
</div>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">[[2,</span> <span class="pre">'world'],</span> <span class="pre">[1,</span> <span class="pre">'hello'],</span> <span class="pre">[3,</span> <span class="pre">'!']]</span></code></p>
</div></blockquote>
</section>
<section id="fetching-query-result-information">
<h3>Fetching query result information<a class="headerlink" href="#fetching-query-result-information" title="Link to this heading"></a></h3>
<p>After running a query, you can fetch information about the results using the same <code class="docutils literal notranslate"><span class="pre">cursor</span></code> object. The examples
below are from the last SELECT query in <a class="reference internal" href="#inserting-and-selecting-data"><span class="std std-ref">Inserting and selecting data</span></a>.</p>
<p id="result-information-example"><strong>rowcount</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>For a SELECT query, rowcount is the number of rows selected.</p></li>
<li><p>For An INSERT query, it is always -1.</p></li>
<li><p>For DDL (CREATE/DROP), it is always 1</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rowcount: &quot;</span><span class="p">,</span> <span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">Rowcount:</span>&#160; <span class="pre">3</span></code></p>
</div></blockquote>
<p><strong>description</strong></p>
<blockquote>
<div><p>description is a list of Column objects, each one responsible for a single column in a result set. Only name and type_code fields get populated, all others are always empty.</p>
<ul>
<li><p>name is the name of the column.</p></li>
<li><p>type_code is the data type of the column.  It can be:</p>
<blockquote>
<div><ul class="simple">
<li><p>a python type (int, float, str, date, datetime)</p></li>
<li><p>an ARRAY object, that signifies a list of some type. The inner type can is stored in <code class="docutils literal notranslate"><span class="pre">.subtype</span></code> field</p></li>
<li><p>a DECIMAL object, that signifies a decimal value. It’s precision and scale are stored in <code class="docutils literal notranslate"><span class="pre">.precision</span></code> and <code class="docutils literal notranslate"><span class="pre">.scale</span></code> fields</p></li>
<li><p>a DATETIME64 object, that signifies a datetime value with an extended precision. The precision is stored in <code class="docutils literal notranslate"><span class="pre">.precision</span></code></p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Description: &quot;</span><span class="p">,</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Returns</strong>: <code class="docutils literal notranslate"><span class="pre">Description:</span>&#160; <span class="pre">[Column(name='id',</span> <span class="pre">type_code=&lt;class</span> <span class="pre">'int'&gt;,</span> <span class="pre">display_size=None,</span> <span class="pre">internal_size=None,</span> <span class="pre">precision=None,</span> <span class="pre">scale=None,</span> <span class="pre">null_ok=None),</span> <span class="pre">Column(name='name',</span> <span class="pre">type_code=&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">display_size=None,</span> <span class="pre">internal_size=None,</span> <span class="pre">precision=None,</span> <span class="pre">scale=None,</span> <span class="pre">null_ok=None)]</span></code></p>
</div></blockquote>
</section>
<section id="executing-parameterized-queries">
<h3>Executing parameterized queries<a class="headerlink" href="#executing-parameterized-queries" title="Link to this heading"></a></h3>
<p id="parameterized-query-execute-example">Parameterized queries (also known as “prepared statements”) format a SQL query with
placeholders and then pass values into those placeholders when the query is run. This
protects against SQL injection attacks and also helps manage dynamic queries that are
likely to change, such as filter UIs or access control.</p>
<p>To run a parameterized query, use the <code class="docutils literal notranslate"><span class="pre">execute()</span></code> cursor method. Add placeholders to
your statement using question marks <code class="docutils literal notranslate"><span class="pre">?</span></code>, and in the second argument pass a tuple of
parameters equal in length to the  number of <code class="docutils literal notranslate"><span class="pre">?</span></code> in the statement.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CREATE FACT TABLE IF NOT EXISTS test_table2 (</span>
<span class="sd">        id INT,</span>
<span class="sd">        name TEXT,</span>
<span class="sd">        date_value DATE</span>
<span class="sd">    )</span>
<span class="sd">    PRIMARY INDEX id;&quot;&quot;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="s2">&quot;INSERT INTO test_table2 VALUES (?, ?, ?)&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;2018-01-01&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p id="parameterized-query-executemany-example">If you need to run the same statement multiple times with different parameter inputs,
you can use the <code class="docutils literal notranslate"><span class="pre">executemany()</span></code> cursor method. This allows multiple tuples to be passed
as values in the second argument.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">executemany</span><span class="p">(</span>
    <span class="s2">&quot;INSERT INTO test_table2 VALUES (?, ?, ?)&quot;</span><span class="p">,</span>
    <span class="p">(</span>
        <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;banana&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-01-01&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;carrot&quot;</span><span class="p">,</span> <span class="s2">&quot;2020-01-01&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;donut&quot;</span><span class="p">,</span> <span class="s2">&quot;2021-01-01&quot;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="setting-session-parameters">
<h3>Setting session parameters<a class="headerlink" href="#setting-session-parameters" title="Link to this heading"></a></h3>
<p>Session parameters are special SQL statements allowing you to modify the behavior of
the current session. For example, you can set the time zone for the current session
using the <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">time_zone</span></code> statement. More information on session parameters can be
found in the relevant <a class="reference external" href="https://docs.firebolt.io/godocs/Reference/system-settings.html">section</a>
in Firebolt docs.</p>
<p>In Python SDK session parameters are stored on the cursor object and are set using the
<code class="docutils literal notranslate"><span class="pre">execute()</span></code> method. This means that each cursor you create will act independently of
each other. Any session parameters on one will have no effect on another cursor.
The example below sets the time zone to UTC and then selects a timestamp with time zone.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SET time_zone = &#39;UTC&#39;&quot;</span><span class="p">)</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT TIMESTAMPTZ &#39;1996-09-03 11:19:33.123456 Europe/Berlin&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively set paramters can be set in a multi-statement query.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SET time_zone = &#39;UTC&#39;; SELECT TIMESTAMPTZ &#39;1996-09-03 11:19:33.123456 Europe/Berlin&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Even when set in a multi-statement query, the session parameters will be set for the
entire session, not just for the duration of the query. To reset the parameter either
set it to a new value or use <cite>flush_parameters()</cite> method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">flush_parameters</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some parameters are not allowed. <cite>account_id</cite>, <cite>output_format</cite>, <cite>database</cite> and <cite>engine</cite> are
internal parameters and should not be set using the <cite>SET</cite> statement. Database and engine
parameters (if enabled on your Firebolt version) can be set via <cite>USE DATABASE</cite> and <cite>USE ENGINE</cite>.</p>
</div>
</section>
<section id="executing-multiple-statement-queries">
<h3>Executing multiple-statement queries<a class="headerlink" href="#executing-multiple-statement-queries" title="Link to this heading"></a></h3>
<p>Multiple-statement queries allow you to run a series of SQL statements sequentially with
just one method call. Statements are separated using a semicolon <code class="docutils literal notranslate"><span class="pre">;</span></code>, similar to making
SQL statements in the Firebolt UI.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SELECT * FROM test_table WHERE id &lt; 4;</span>
<span class="sd">    SELECT * FROM test_table WHERE id &gt; 2;</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First query: &quot;</span><span class="p">,</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">cursor</span><span class="o">.</span><span class="n">nextset</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second query: &quot;</span><span class="p">,</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
<span class="k">assert</span> <span class="n">cursor</span><span class="o">.</span><span class="n">nextset</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span>

<span class="n">cursor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Returns</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">First</span> <span class="n">query</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;carrot&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span>
              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]]</span>
<span class="n">Second</span> <span class="n">query</span><span class="p">:</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;carrot&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span>
               <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;donut&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple statement queries are not able to use placeholder values for parameterized queries.</p>
</div>
</section>
</section>
<section id="asynchronous-query-execution">
<h2>Asynchronous query execution<a class="headerlink" href="#asynchronous-query-execution" title="Link to this heading"></a></h2>
<p>Asynchronous Python SDK
functionality is used to write concurrent code. Unlike in a synchronous approach, when executing
a query is a blocking operation, this approach allows doing other processing or queries while the
original query is waiting on the network or the server to respond. This is especially useful when
executing slower queries.</p>
<p>Make sure you’re familiar with the <a class="reference external" href="https://docs.python.org/3/library/asyncio.html">Asyncio approach</a>
before using asynchronous Python SDK, as it requires special async/await syntax.</p>
<section id="simple-asynchronous-example">
<h3>Simple asynchronous example<a class="headerlink" href="#simple-asynchronous-example" title="Link to this heading"></a></h3>
<p>This example illustrates a simple query execution via the async Python SDK. It does not have any
performance benefits, but rather shows the difference in syntax from the synchronous version.
It can be extended to run alongside of other operations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">asyncio</span> <span class="kn">import</span> <span class="n">run</span>
<span class="kn">from</span> <span class="nn">firebolt.async_db</span> <span class="kn">import</span> <span class="n">connect</span> <span class="k">as</span> <span class="n">async_connect</span>
<span class="kn">from</span> <span class="nn">firebolt.client.auth</span> <span class="kn">import</span> <span class="n">ClientCredentials</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">run_query</span><span class="p">():</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="s2">&quot;your_service_account_id&quot;</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="s2">&quot;your_service_account_secret&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="s2">&quot;your_engine&quot;</span>
    <span class="n">database_name</span> <span class="o">=</span> <span class="s2">&quot;your_database&quot;</span>
    <span class="n">account_name</span> <span class="o">=</span> <span class="s2">&quot;your_account&quot;</span>

    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;select * from my_table&quot;</span>

    <span class="k">async</span> <span class="k">with</span> <span class="k">await</span> <span class="n">async_connect</span><span class="p">(</span>
        <span class="n">engine_name</span><span class="o">=</span><span class="n">engine_name</span><span class="p">,</span>
        <span class="n">database</span><span class="o">=</span><span class="n">database_name</span><span class="p">,</span>
        <span class="n">account_name</span><span class="o">=</span><span class="n">account_name</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">ClientCredentials</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">secret</span><span class="p">),</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

        <span class="c1"># Asyncronously execute a query</span>
        <span class="n">rowcount</span> <span class="o">=</span> <span class="k">await</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

        <span class="c1"># Asyncronously fetch a result</span>
        <span class="n">single_row</span> <span class="o">=</span> <span class="k">await</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
        <span class="n">multiple_rows</span> <span class="o">=</span> <span class="k">await</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">all_remaining_rows</span> <span class="o">=</span> <span class="k">await</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="c1"># Run async `run_query` from the synchronous context of your script</span>
<span class="n">run</span><span class="p">(</span><span class="n">run_query</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="running-multiple-queries-in-parallel">
<h3>Running multiple queries in parallel<a class="headerlink" href="#running-multiple-queries-in-parallel" title="Link to this heading"></a></h3>
<p>Building up on the previous example, we can execute several queries concurently.
This is especially useful when queries do not depend on each other and can be run
at the same time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">asyncio</span> <span class="kn">import</span> <span class="n">gather</span><span class="p">,</span> <span class="n">run</span>
<span class="kn">from</span> <span class="nn">firebolt.async_db</span> <span class="kn">import</span> <span class="n">connect</span> <span class="k">as</span> <span class="n">async_connect</span>
<span class="kn">from</span> <span class="nn">firebolt.client.auth</span> <span class="kn">import</span> <span class="n">ClientCredentials</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">execute_sql</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="c1"># Create a new cursor for every query</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="c1"># Wait for cursor to execute a query</span>
    <span class="k">await</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="c1"># Return full query result</span>
    <span class="k">return</span> <span class="k">await</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">run_multiple_queries</span><span class="p">():</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="s2">&quot;your_service_account_id&quot;</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="s2">&quot;your_service_account_secret&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="s2">&quot;your_engine&quot;</span>
    <span class="n">database_name</span> <span class="o">=</span> <span class="s2">&quot;your_database&quot;</span>
    <span class="n">account_name</span> <span class="o">=</span> <span class="s2">&quot;your_account&quot;</span>

    <span class="n">queries</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;select * from table_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;select * from table_2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;select * from table_3&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">async</span> <span class="k">with</span> <span class="k">await</span> <span class="n">async_connect</span><span class="p">(</span>
        <span class="n">engine_name</span><span class="o">=</span><span class="n">engine_name</span><span class="p">,</span>
        <span class="n">database</span><span class="o">=</span><span class="n">database_name</span><span class="p">,</span>
        <span class="n">account_name</span><span class="o">=</span><span class="n">account_name</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">ClientCredentials</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">secret</span><span class="p">),</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
        <span class="c1"># Create async tasks for every query</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">execute_sql</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span> <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">]</span>
        <span class="c1"># Execute tasks concurently</span>
        <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>
        <span class="c1"># Print query results</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">run</span><span class="p">(</span><span class="n">run_multiple_queries</span><span class="p">())</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will run all queries specified in <code class="docutils literal notranslate"><span class="pre">queries</span></code> list at the same time. With heavy queries you
have to be mindful of the engine capability here. Excessive parallelisations can lead to degraded
performance. You should also make sure the machine running this code has enough RAM to store all
the results you’re fetching.</p>
<p><a class="reference internal" href="#concurrent-limit"><span class="std std-ref">Limiting number of conccurent queries</span></a> suggests a way to avoid this.</p>
</div>
</section>
<section id="limiting-number-of-conccurent-queries">
<span id="concurrent-limit"></span><h3>Limiting number of conccurent queries<a class="headerlink" href="#limiting-number-of-conccurent-queries" title="Link to this heading"></a></h3>
<p>It’s generally a good practice to limit a number of queries running at the same time. It ensures a
load on both server and client machines can be controlled. A suggested way is to use the
<a class="reference external" href="https://docs.python.org/3/library/asyncio-sync.html#semaphore">Semaphore</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">asyncio</span> <span class="kn">import</span> <span class="n">gather</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">Semaphore</span>
<span class="kn">from</span> <span class="nn">firebolt.async_db</span> <span class="kn">import</span> <span class="n">connect</span> <span class="k">as</span> <span class="n">async_connect</span>
<span class="kn">from</span> <span class="nn">firebolt.client.auth</span> <span class="kn">import</span> <span class="n">ClientCredentials</span>


<span class="n">MAX_PARALLEL</span> <span class="o">=</span> <span class="mi">2</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">gather_limited</span><span class="p">(</span><span class="n">tasks</span><span class="p">,</span> <span class="n">max_parallel</span><span class="p">):</span>
    <span class="n">sem</span> <span class="o">=</span> <span class="n">Semaphore</span><span class="p">(</span><span class="n">max_parallel</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">limited_task</span><span class="p">(</span><span class="n">task</span><span class="p">):</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">sem</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">task</span>

    <span class="k">await</span> <span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">limited_task</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">])</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">execute_sql</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="c1"># Create a new cursor for every query</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="c1"># Wait for cursor to execute a query</span>
    <span class="k">await</span> <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="c1"># Return full query result</span>
    <span class="k">return</span> <span class="k">await</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>


<span class="k">async</span> <span class="k">def</span> <span class="nf">run_multiple_queries</span><span class="p">():</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="s2">&quot;your_service_account_id&quot;</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="s2">&quot;your_service_account_secret&quot;</span>
    <span class="n">engine_name</span> <span class="o">=</span> <span class="s2">&quot;your_engine&quot;</span>
    <span class="n">database_name</span> <span class="o">=</span> <span class="s2">&quot;your_database&quot;</span>
    <span class="n">account_name</span> <span class="o">=</span> <span class="s2">&quot;your_account&quot;</span>

    <span class="n">queries</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;select * from table_1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;select * from table_2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;select * from table_3&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">async</span> <span class="k">with</span> <span class="k">await</span> <span class="n">async_connect</span><span class="p">(</span>
        <span class="n">engine_name</span><span class="o">=</span><span class="n">engine_name</span><span class="p">,</span>
        <span class="n">database</span><span class="o">=</span><span class="n">database_name</span><span class="p">,</span>
        <span class="n">account_name</span><span class="o">=</span><span class="n">account_name</span><span class="p">,</span>
        <span class="n">auth</span><span class="o">=</span><span class="n">ClientCredentials</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">secret</span><span class="p">),</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">connection</span><span class="p">:</span>
        <span class="c1"># Create async tasks for every query</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">execute_sql</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">query</span><span class="p">)</span> <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">]</span>
        <span class="c1"># Execute tasks concurently, limiting the parallelism</span>
        <span class="n">results</span> <span class="o">=</span> <span class="k">await</span> <span class="n">gather_limited</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span> <span class="n">MAX_PARALLEL</span><span class="p">)</span>
        <span class="c1"># Print query results</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">run</span><span class="p">(</span><span class="n">run_multiple_queries</span><span class="p">())</span>
</pre></div>
</div>
</section>
</section>
<section id="thread-safety">
<h2>Thread safety<a class="headerlink" href="#thread-safety" title="Link to this heading"></a></h2>
<p>Thread safety is set to 2, meaning it’s safe to share the module and
<a class="reference internal" href="firebolt.db.html#connection"><span class="std std-ref">Connection</span></a> object across threads.
<a class="reference internal" href="firebolt.db.html#module-firebolt.db.cursor"><span class="std std-ref">Cursor</span></a> is a lightweight object that should be instantiated
by calling <code class="docutils literal notranslate"><span class="pre">connection.cursor()</span></code> within a thread and should not be shared across different threads.
Similarly, in an asynchronous context the Cursor obejct should not be shared across tasks
as it will lead to a nondeterministic data returned. Follow the best practice from the
<a class="reference internal" href="#running-multiple-queries-in-parallel"><span class="std std-ref">Running multiple queries in parallel</span></a>.</p>
</section>
<section id="using-date-and-datetime-values">
<h2>Using DATE and DATETIME values<a class="headerlink" href="#using-date-and-datetime-values" title="Link to this heading"></a></h2>
<p>DATE, DATETIME and TIMESTAMP values used in SQL insertion statements must be provided in
a specific format; otherwise they could be read incorrectly.</p>
<ul class="simple">
<li><p>DATE values should be formatted as <strong>YYYY-MM-DD</strong></p></li>
<li><p>DATETIME and TIMESTAMP values should be formatted as <strong>YYYY-MM-DD HH:MM:SS.SSSSSS</strong></p></li>
</ul>
<p>The <a class="reference external" href="https://docs.python.org/3/library/datetime.html">datetime</a> module from the Python
standard library contains various classes and methods to format DATE, TIMESTAMP and
DATETIME data types.</p>
<p>You can import this module as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Firebolt-python-sdk" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Managing_resources.html" class="btn btn-neutral float-right" title="Managing engines and databases" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Firebolt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
{"uid":"d41f7800e9f2b66","name":"test_is_async_query_running_success[RUNNING-True-False]","fullName":"tests.unit.db.test_connection#test_is_async_query_running_success","historyId":"ee79ffb2ae959b7836e56ef50f9e8a62","time":{"start":1737718521861,"stop":1737718521949,"duration":88},"description":"Test is_async_query_running method","descriptionHtml":"<p>Test is_async_query_running method</p>\n","status":"failed","statusMessage":"AssertionError: assert None is False\n +  where None = <bound method Connection.is_async_query_successful of <firebolt.db.connection.Connection object at 0x7f52b91dff20>>('token')\n +    where <bound method Connection.is_async_query_successful of <firebolt.db.connection.Connection object at 0x7f52b91dff20>> = <firebolt.db.connection.Connection object at 0x7f52b91dff20>.is_async_query_successful","statusTrace":"db_name = 'database', account_name = 'mock_account_name'\nengine_name = 'mock_engine_name'\nauth = <firebolt.client.auth.client_credentials.ClientCredentials object at 0x7f52b8f39c40>\napi_endpoint = 'api-dev.mock.firebolt.io'\nhttpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f52b97745e0>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\nasync_query_callback_factory = <function async_query_callback_factory.<locals>.create_callback at 0x7f52b967dd30>\nasync_query_data = [['developer', 'ecosystem_ci', '2025-01-23 14:08:06.087953+00', '2025-01-23 14:08:06.134208+00', '2025-01-23 14:08:06.410542+00', 'RUNNING', ...]]\nasync_query_meta = [('account_name', 'text null'), ('user_name', 'text null'), ('submitted_time', 'timestamptz null'), ('start_time', 'timestamptz null'), ('end_time', 'timestamptz null'), ('status', 'text null'), ...]\nmock_connection_flow = <function mock_connection_flow.<locals>.inner at 0x7f52b90bf3a0>\nserver_status = 'RUNNING', expected_running = True, expected_success = False\n\n    @mark.parametrize(\n        \"server_status,expected_running,expected_success\",\n        [\n            (\"RUNNING\", True, False),\n            (\"ENDED_SUCCESSFULLY\", False, True),\n            (\"FAILED\", False, False),\n            (\"CANCELLED\", False, False),\n        ],\n    )\n    def test_is_async_query_running_success(\n        db_name: str,\n        account_name: str,\n        engine_name: str,\n        auth: Auth,\n        api_endpoint: str,\n        httpx_mock: HTTPXMock,\n        query_url: str,\n        async_query_callback_factory: Callable,\n        async_query_data: List[List[ColType]],\n        async_query_meta: List[Tuple[str, str]],\n        mock_connection_flow: Callable,\n        server_status: str,\n        expected_running: bool,\n        expected_success: bool,\n    ):\n        \"\"\"Test is_async_query_running method\"\"\"\n        mock_connection_flow()\n        async_query_data[0][5] = server_status\n        async_query_status_running_callback = async_query_callback_factory(\n            async_query_data, async_query_meta\n        )\n    \n        httpx_mock.add_callback(\n            async_query_status_running_callback,\n            url=query_url,\n            match_content=\"CALL fb_GetAsyncStatus('token')\".encode(\"utf-8\"),\n        )\n    \n        with connect(\n            database=db_name,\n            auth=auth,\n            engine_name=engine_name,\n            account_name=account_name,\n            api_endpoint=api_endpoint,\n        ) as connection:\n            assert connection.is_async_query_running(\"token\") is expected_running\n>           assert connection.is_async_query_successful(\"token\") is expected_success\nE           AssertionError: assert None is False\nE            +  where None = <bound method Connection.is_async_query_successful of <firebolt.db.connection.Connection object at 0x7f52b91dff20>>('token')\nE            +    where <bound method Connection.is_async_query_successful of <firebolt.db.connection.Connection object at 0x7f52b91dff20>> = <firebolt.db.connection.Connection object at 0x7f52b91dff20>.is_async_query_successful\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/db/test_connection.py:475: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"global_fake_fs","time":{"start":1737718521823,"stop":1737718521826,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clear_cache","time":{"start":1737718521823,"stop":1737718521823,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"engine_name","time":{"start":1737718521826,"stop":1737718521826,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"account_name","time":{"start":1737718521826,"stop":1737718521826,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"client_id","time":{"start":1737718521826,"stop":1737718521826,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"db_name","time":{"start":1737718521826,"stop":1737718521826,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"auth","time":{"start":1737718521827,"stop":1737718521855,"duration":28},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"client_secret","time":{"start":1737718521827,"stop":1737718521827,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"non_mocked_hosts","time":{"start":1737718521855,"stop":1737718521855,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"assert_all_responses_were_requested","time":{"start":1737718521855,"stop":1737718521855,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api_endpoint","time":{"start":1737718521855,"stop":1737718521855,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch","time":{"start":1737718521855,"stop":1737718521855,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"engine_url","time":{"start":1737718521856,"stop":1737718521856,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"httpx_mock","time":{"start":1737718521856,"stop":1737718521856,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"query_statistics","time":{"start":1737718521856,"stop":1737718521856,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"query_url","time":{"start":1737718521856,"stop":1737718521856,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"async_query_callback_factory","time":{"start":1737718521856,"stop":1737718521856,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"auth_url","time":{"start":1737718521857,"stop":1737718521857,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"async_query_data","time":{"start":1737718521857,"stop":1737718521857,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"check_credentials_callback","time":{"start":1737718521857,"stop":1737718521857,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"async_query_meta","time":{"start":1737718521857,"stop":1737718521857,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"auth_endpoint","time":{"start":1737718521857,"stop":1737718521857,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"access_token","time":{"start":1737718521857,"stop":1737718521857,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"get_system_engine_url","time":{"start":1737718521858,"stop":1737718521858,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"system_engine_url","time":{"start":1737718521858,"stop":1737718521858,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"mock_system_engine_connection_flow","time":{"start":1737718521858,"stop":1737718521858,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"use_database_callback","time":{"start":1737718521858,"stop":1737718521858,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"get_system_engine_callback","time":{"start":1737718521858,"stop":1737718521858,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"use_engine_callback","time":{"start":1737718521859,"stop":1737718521859,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"mock_connection_flow","time":{"start":1737718521859,"stop":1737718521859,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"system_engine_no_db_query_url","time":{"start":1737718521859,"stop":1737718521859,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"system_engine_query_url","time":{"start":1737718521859,"stop":1737718521859,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"httpx_mock::0","time":{"start":1737718521976,"stop":1737718521976,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"monkeypatch::0","time":{"start":1737718521978,"stop":1737718521978,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"global_fake_fs::0","time":{"start":1737718521981,"stop":1737718521981,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.unit.db"},{"name":"suite","value":"test_connection"},{"name":"host","value":"fv-az1671-230"},{"name":"thread","value":"2304-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.unit.db.test_connection"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"expected_running","value":"True"},{"name":"expected_success","value":"False"},{"name":"server_status","value":"'RUNNING'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"d41f7800e9f2b66.json","parameterValues":["True","False","'RUNNING'"]}
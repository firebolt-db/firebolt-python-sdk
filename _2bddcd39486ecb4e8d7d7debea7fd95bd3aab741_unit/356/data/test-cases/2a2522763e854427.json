{"uid":"2a2522763e854427","name":"test_cursor_unknown_error_body_logging","fullName":"tests.unit.V1.db.test_cursor#test_cursor_unknown_error_body_logging","historyId":"9784a6f80e3f9e8356e549c03737bdb8","time":{"start":1731640504627,"stop":1731640504691,"duration":64},"status":"broken","statusMessage":"KeyError: <_pytest.stash.StashKey object at 0x7f79b133e2c0>","statusTrace":"httpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f79add7af70>\nauth_callback = <function auth_callback.<locals>.do_mock at 0x7f79adcf7e50>\nauth_url = 'https://api-dev.mock.firebolt.io/auth/v1/login'\ncursor = <firebolt.db.cursor.CursorV1 object at 0x7f79ae188e00>\ncaplog = <_pytest.logging.LogCaptureFixture object at 0x7f79addd1a30>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\n\n    def test_cursor_unknown_error_body_logging(\n        httpx_mock: HTTPXMock,\n        auth_callback: Callable,\n        auth_url: str,\n        cursor: Cursor,\n        caplog: LogCaptureFixture,\n        query_url: str,\n    ):\n        httpx_mock.add_callback(auth_callback, url=auth_url)\n        actual_error_body = \"Your query was incorrect\"\n        httpx_mock.add_callback(\n            lambda *args, **kwargs: Response(\n                status_code=codes.NOT_IMPLEMENTED, content=actual_error_body\n            ),\n            url=query_url,\n        )\n        with raises(HTTPStatusError):\n            cursor.execute(\"select 1\")\n>       assert actual_error_body in caplog.text\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/V1/db/test_cursor.py:606: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:408: in text\n    return _remove_ansi_escape_sequences(self.handler.stream.getvalue())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:388: in handler\n    return self._item.stash[caplog_handler_key]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.stash.Stash object at 0x7f79af3267f0>\nkey = <_pytest.stash.StashKey object at 0x7f79b133e2c0>\n\n    def __getitem__(self, key: StashKey[T]) -> T:\n        \"\"\"Get the value for key.\n    \n        Raises ``KeyError`` if the key wasn't set before.\n        \"\"\"\n>       return cast(T, self._storage[key])\nE       KeyError: <_pytest.stash.StashKey object at 0x7f79b133e2c0>\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/stash.py:80: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"clear_cache","time":{"start":1731640504349,"stop":1731640504349,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"global_fake_fs","time":{"start":1731640504349,"stop":1731640504355,"duration":6},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"KeyError: <_pytest.stash.StashKey object at 0x7f79b133e2c0>","statusTrace":"httpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f79add7af70>\nauth_callback = <function auth_callback.<locals>.do_mock at 0x7f79adcf7e50>\nauth_url = 'https://api-dev.mock.firebolt.io/auth/v1/login'\ncursor = <firebolt.db.cursor.CursorV1 object at 0x7f79ae188e00>\ncaplog = <_pytest.logging.LogCaptureFixture object at 0x7f79addd1a30>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\n\n    def test_cursor_unknown_error_body_logging(\n        httpx_mock: HTTPXMock,\n        auth_callback: Callable,\n        auth_url: str,\n        cursor: Cursor,\n        caplog: LogCaptureFixture,\n        query_url: str,\n    ):\n        httpx_mock.add_callback(auth_callback, url=auth_url)\n        actual_error_body = \"Your query was incorrect\"\n        httpx_mock.add_callback(\n            lambda *args, **kwargs: Response(\n                status_code=codes.NOT_IMPLEMENTED, content=actual_error_body\n            ),\n            url=query_url,\n        )\n        with raises(HTTPStatusError):\n            cursor.execute(\"select 1\")\n>       assert actual_error_body in caplog.text\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/V1/db/test_cursor.py:606: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:408: in text\n    return _remove_ansi_escape_sequences(self.handler.stream.getvalue())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:388: in handler\n    return self._item.stash[caplog_handler_key]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.stash.Stash object at 0x7f79af3267f0>\nkey = <_pytest.stash.StashKey object at 0x7f79b133e2c0>\n\n    def __getitem__(self, key: StashKey[T]) -> T:\n        \"\"\"Get the value for key.\n    \n        Raises ``KeyError`` if the key wasn't set before.\n        \"\"\"\n>       return cast(T, self._storage[key])\nE       KeyError: <_pytest.stash.StashKey object at 0x7f79b133e2c0>\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/stash.py:80: KeyError","steps":[],"attachments":[{"uid":"4557ee04fdf769c0","name":"log","source":"4557ee04fdf769c0.txt","type":"text/plain","size":87}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"global_fake_fs::0","time":{"start":1731640504753,"stop":1731640504754,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.unit.V1.db"},{"name":"suite","value":"test_cursor"},{"name":"host","value":"fv-az1208-77"},{"name":"thread","value":"2172-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.unit.V1.db.test_cursor"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":76,"skipped":0,"passed":58,"unknown":0,"total":134},"items":[{"uid":"b2b6438b51f355d0","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/359//#testresult/b2b6438b51f355d0","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fa986703280>","time":{"start":1731640369257,"stop":1731640369301,"duration":44}},{"uid":"8db072fbea4ee1f1","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/355//#testresult/8db072fbea4ee1f1","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f36296bf2a0>","time":{"start":1731553778220,"stop":1731553778251,"duration":31}},{"uid":"12fc4ee23040dc7f","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/358//#testresult/12fc4ee23040dc7f","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f101e57f300>","time":{"start":1731553643870,"stop":1731553643930,"duration":60}},{"uid":"135d796fe664d394","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/354//#testresult/135d796fe664d394","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f0aae9232a0>","time":{"start":1731467343923,"stop":1731467343960,"duration":37}},{"uid":"26370c581a590dff","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/357//#testresult/26370c581a590dff","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f346efbf2a0>","time":{"start":1731467198769,"stop":1731467198803,"duration":34}},{"uid":"558cbc12309a6e4","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/353//#testresult/558cbc12309a6e4","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fd9328ef2c0>","time":{"start":1731380844516,"stop":1731380844553,"duration":37}},{"uid":"fb1bab9feb88251","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/356//#testresult/fb1bab9feb88251","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fc8819ff2a0>","time":{"start":1731380703840,"stop":1731380703871,"duration":31}},{"uid":"1ce75969dc4bfa77","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/352//#testresult/1ce75969dc4bfa77","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f2c6617f2e0>","time":{"start":1731294598024,"stop":1731294598064,"duration":40}},{"uid":"77efa32a2ec58e09","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/355//#testresult/77efa32a2ec58e09","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fc3940c42c0>","time":{"start":1731294446596,"stop":1731294446650,"duration":54}},{"uid":"dea90c95eeb8619c","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/351//#testresult/dea90c95eeb8619c","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fe730bff2a0>","time":{"start":1731208194344,"stop":1731208194372,"duration":28}},{"uid":"7bcf961774dfcfcf","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/354//#testresult/7bcf961774dfcfcf","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f1d892e02c0>","time":{"start":1731208065470,"stop":1731208065559,"duration":89}},{"uid":"d6aab12765beb93c","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/350//#testresult/d6aab12765beb93c","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f0235ebe2e0>","time":{"start":1731121939655,"stop":1731121939702,"duration":47}},{"uid":"1d94b60da9bbe5b6","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/353//#testresult/1d94b60da9bbe5b6","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fb26dca02e0>","time":{"start":1731121551073,"stop":1731121551104,"duration":31}},{"uid":"7bc07aae14b012e9","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/349//#testresult/7bc07aae14b012e9","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f78ee2ef2c0>","time":{"start":1731035307508,"stop":1731035307531,"duration":23}},{"uid":"8e35e7ad64936e70","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/352//#testresult/8e35e7ad64936e70","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fa8a3dff300>","time":{"start":1731035165866,"stop":1731035165875,"duration":9}},{"uid":"99c34cd99bc12d9f","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/348//#testresult/99c34cd99bc12d9f","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f5bdffff2a0>","time":{"start":1730948991062,"stop":1730948991112,"duration":50}},{"uid":"45b3c18c9d6c8e58","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/351//#testresult/45b3c18c9d6c8e58","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fe2e097f2c0>","time":{"start":1730948862416,"stop":1730948862444,"duration":28}},{"uid":"cae2f9450d5ff78f","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/347//#testresult/cae2f9450d5ff78f","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f1d437c1280>","time":{"start":1730862483099,"stop":1730862483224,"duration":125}},{"uid":"f6527f5889134f85","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/350//#testresult/f6527f5889134f85","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fb4256bf2e0>","time":{"start":1730862318250,"stop":1730862318288,"duration":38}},{"uid":"9255601820e3d2ec","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/346//#testresult/9255601820e3d2ec","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f806768d0c0>","time":{"start":1730776116572,"stop":1730776116611,"duration":39}}]},"tags":[]},"source":"2a2522763e854427.json","parameterValues":[]}
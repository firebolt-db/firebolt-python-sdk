{"uid":"f58d8c4972132dac","name":"test_cursor_unknown_error_body_logging","fullName":"tests.unit.db.test_cursor#test_cursor_unknown_error_body_logging","historyId":"9e9db9d6284af6f68416158c85e8fb70","time":{"start":1729653075687,"stop":1729653075689,"duration":2},"status":"broken","statusMessage":"KeyError: <_pytest.stash.StashKey object at 0x7f5adb97f2a0>","statusTrace":"httpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f5ad7c90df0>\ncursor = <firebolt.db.cursor.CursorV2 object at 0x7f5ad7acde00>\ncaplog = <_pytest.logging.LogCaptureFixture object at 0x7f5ad873f5e0>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\n\n    def test_cursor_unknown_error_body_logging(\n        httpx_mock: HTTPXMock, cursor: Cursor, caplog: LogCaptureFixture, query_url: str\n    ):\n        actual_error_body = \"Your query was incorrect\"\n        httpx_mock.add_callback(\n            lambda *args, **kwargs: Response(\n                status_code=codes.NOT_IMPLEMENTED, content=actual_error_body\n            ),\n            url=query_url,\n        )\n        with raises(HTTPStatusError):\n            cursor.execute(\"select 1\")\n>       assert actual_error_body in caplog.text\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/db/test_cursor.py:591: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:408: in text\n    return _remove_ansi_escape_sequences(self.handler.stream.getvalue())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:388: in handler\n    return self._item.stash[caplog_handler_key]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.stash.Stash object at 0x7f5ad9381be0>\nkey = <_pytest.stash.StashKey object at 0x7f5adb97f2a0>\n\n    def __getitem__(self, key: StashKey[T]) -> T:\n        \"\"\"Get the value for key.\n    \n        Raises ``KeyError`` if the key wasn't set before.\n        \"\"\"\n>       return cast(T, self._storage[key])\nE       KeyError: <_pytest.stash.StashKey object at 0x7f5adb97f2a0>\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/stash.py:80: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"clear_cache","time":{"start":1729653075419,"stop":1729653075419,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false},{"name":"global_fake_fs","time":{"start":1729653075419,"stop":1729653075424,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false}],"testStage":{"status":"broken","statusMessage":"KeyError: <_pytest.stash.StashKey object at 0x7f5adb97f2a0>","statusTrace":"httpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f5ad7c90df0>\ncursor = <firebolt.db.cursor.CursorV2 object at 0x7f5ad7acde00>\ncaplog = <_pytest.logging.LogCaptureFixture object at 0x7f5ad873f5e0>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\n\n    def test_cursor_unknown_error_body_logging(\n        httpx_mock: HTTPXMock, cursor: Cursor, caplog: LogCaptureFixture, query_url: str\n    ):\n        actual_error_body = \"Your query was incorrect\"\n        httpx_mock.add_callback(\n            lambda *args, **kwargs: Response(\n                status_code=codes.NOT_IMPLEMENTED, content=actual_error_body\n            ),\n            url=query_url,\n        )\n        with raises(HTTPStatusError):\n            cursor.execute(\"select 1\")\n>       assert actual_error_body in caplog.text\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/db/test_cursor.py:591: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:408: in text\n    return _remove_ansi_escape_sequences(self.handler.stream.getvalue())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:388: in handler\n    return self._item.stash[caplog_handler_key]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.stash.Stash object at 0x7f5ad9381be0>\nkey = <_pytest.stash.StashKey object at 0x7f5adb97f2a0>\n\n    def __getitem__(self, key: StashKey[T]) -> T:\n        \"\"\"Get the value for key.\n    \n        Raises ``KeyError`` if the key wasn't set before.\n        \"\"\"\n>       return cast(T, self._storage[key])\nE       KeyError: <_pytest.stash.StashKey object at 0x7f5adb97f2a0>\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/stash.py:80: KeyError","steps":[],"attachments":[{"uid":"61629f22ab926c97","name":"log","source":"61629f22ab926c97.txt","type":"text/plain","size":87}],"parameters":[],"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false,"shouldDisplayMessage":true},"afterStages":[{"name":"global_fake_fs::0","time":{"start":1729653075808,"stop":1729653075808,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false,"shouldDisplayMessage":false}],"labels":[{"name":"parentSuite","value":"tests.unit.db"},{"name":"suite","value":"test_cursor"},{"name":"host","value":"fv-az1435-534"},{"name":"thread","value":"2138-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.unit.db.test_cursor"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":30,"skipped":0,"passed":58,"unknown":0,"total":88},"items":[{"uid":"145bda0bd13d0c98","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/336//#testresult/145bda0bd13d0c98","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fc43febf2e0>","time":{"start":1729652934932,"stop":1729652934935,"duration":3}},{"uid":"3e8148fc1f9fe2a0","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/332//#testresult/3e8148fc1f9fe2a0","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f6c66a81280>","time":{"start":1729566726626,"stop":1729566726628,"duration":2}},{"uid":"e2ad414b95538d5d","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/335//#testresult/e2ad414b95538d5d","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f1f42fbf2c0>","time":{"start":1729566590242,"stop":1729566590245,"duration":3}},{"uid":"28f65232613ff476","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/331//#testresult/28f65232613ff476","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fa5c1cef320>","time":{"start":1729480435354,"stop":1729480435357,"duration":3}},{"uid":"7e58c798c41b6e37","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/334//#testresult/7e58c798c41b6e37","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f3dafcd32a0>","time":{"start":1729480308513,"stop":1729480308516,"duration":3}},{"uid":"76efa622b39f1bc","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/330//#testresult/76efa622b39f1bc","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f4c3678d0c0>","time":{"start":1729394086078,"stop":1729394086081,"duration":3}},{"uid":"75f93bb90a3b6f14","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/333//#testresult/75f93bb90a3b6f14","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f590d9ff300>","time":{"start":1729393947694,"stop":1729393947697,"duration":3}},{"uid":"fd0404842f2e9851","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/329//#testresult/fd0404842f2e9851","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fa14317f2e0>","time":{"start":1729307418575,"stop":1729307418577,"duration":2}},{"uid":"f1b8cc1735c45b37","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/332//#testresult/f1b8cc1735c45b37","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f2b2140e0c0>","time":{"start":1729307298053,"stop":1729307298056,"duration":3}},{"uid":"d8653c0d753601e4","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/328//#testresult/d8653c0d753601e4","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f216017f2e0>","time":{"start":1729221121302,"stop":1729221121304,"duration":2}},{"uid":"a14a72785b1940b6","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/331//#testresult/a14a72785b1940b6","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f77be08e0c0>","time":{"start":1729220974982,"stop":1729220974985,"duration":3}},{"uid":"e1188cf653ba9176","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/327//#testresult/e1188cf653ba9176","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f363ca02280>","time":{"start":1729134671364,"stop":1729134671367,"duration":3}},{"uid":"5dc6d44e3c3515d6","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/330//#testresult/5dc6d44e3c3515d6","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f8d72aa82c0>","time":{"start":1729134535801,"stop":1729134535804,"duration":3}},{"uid":"23729154c0c95baf","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/326//#testresult/23729154c0c95baf","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f11c453f320>","time":{"start":1729048388346,"stop":1729048388349,"duration":3}},{"uid":"a8ecf420b3bf6f67","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/329//#testresult/a8ecf420b3bf6f67","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fa5687ff320>","time":{"start":1729048236229,"stop":1729048236232,"duration":3}},{"uid":"541bd8144e017ef8","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/325//#testresult/541bd8144e017ef8","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fdbbbf2f2e0>","time":{"start":1728961933777,"stop":1728961933780,"duration":3}},{"uid":"78a5a571206e5d17","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/328//#testresult/78a5a571206e5d17","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fc2a97ad2e0>","time":{"start":1728961791280,"stop":1728961791283,"duration":3}},{"uid":"320cc6c546dc968d","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/324//#testresult/320cc6c546dc968d","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f23bac45280>","time":{"start":1728875639453,"stop":1728875639456,"duration":3}},{"uid":"60b86ebb0df93acc","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/327//#testresult/60b86ebb0df93acc","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f03c46ff2a0>","time":{"start":1728875485046,"stop":1728875485049,"duration":3}},{"uid":"97e937b0a101164","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/323//#testresult/97e937b0a101164","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fdbab9bd300>","time":{"start":1728789203526,"stop":1728789203529,"duration":3}}]},"tags":[]},"source":"f58d8c4972132dac.json","parameterValues":[]}
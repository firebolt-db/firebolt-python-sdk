{"uid":"efb49cb1d6b7db77","name":"test_cursor_unknown_error_body_logging","fullName":"tests.unit.db.test_cursor#test_cursor_unknown_error_body_logging","historyId":"9e9db9d6284af6f68416158c85e8fb70","time":{"start":1730776005099,"stop":1730776005101,"duration":2},"status":"broken","statusMessage":"KeyError: <_pytest.stash.StashKey object at 0x7f2c34d41280>","statusTrace":"httpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f2c34640610>\ncursor = <firebolt.db.cursor.CursorV2 object at 0x7f2c31e5f880>\ncaplog = <_pytest.logging.LogCaptureFixture object at 0x7f2c317ca2e0>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\n\n    def test_cursor_unknown_error_body_logging(\n        httpx_mock: HTTPXMock, cursor: Cursor, caplog: LogCaptureFixture, query_url: str\n    ):\n        actual_error_body = \"Your query was incorrect\"\n        httpx_mock.add_callback(\n            lambda *args, **kwargs: Response(\n                status_code=codes.NOT_IMPLEMENTED, content=actual_error_body\n            ),\n            url=query_url,\n        )\n        with raises(HTTPStatusError):\n            cursor.execute(\"select 1\")\n>       assert actual_error_body in caplog.text\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/db/test_cursor.py:591: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:408: in text\n    return _remove_ansi_escape_sequences(self.handler.stream.getvalue())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:388: in handler\n    return self._item.stash[caplog_handler_key]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.stash.Stash object at 0x7f2c329e7100>\nkey = <_pytest.stash.StashKey object at 0x7f2c34d41280>\n\n    def __getitem__(self, key: StashKey[T]) -> T:\n        \"\"\"Get the value for key.\n    \n        Raises ``KeyError`` if the key wasn't set before.\n        \"\"\"\n>       return cast(T, self._storage[key])\nE       KeyError: <_pytest.stash.StashKey object at 0x7f2c34d41280>\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/stash.py:80: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"clear_cache","time":{"start":1730776004828,"stop":1730776004829,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"global_fake_fs","time":{"start":1730776004829,"stop":1730776004834,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"KeyError: <_pytest.stash.StashKey object at 0x7f2c34d41280>","statusTrace":"httpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f2c34640610>\ncursor = <firebolt.db.cursor.CursorV2 object at 0x7f2c31e5f880>\ncaplog = <_pytest.logging.LogCaptureFixture object at 0x7f2c317ca2e0>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\n\n    def test_cursor_unknown_error_body_logging(\n        httpx_mock: HTTPXMock, cursor: Cursor, caplog: LogCaptureFixture, query_url: str\n    ):\n        actual_error_body = \"Your query was incorrect\"\n        httpx_mock.add_callback(\n            lambda *args, **kwargs: Response(\n                status_code=codes.NOT_IMPLEMENTED, content=actual_error_body\n            ),\n            url=query_url,\n        )\n        with raises(HTTPStatusError):\n            cursor.execute(\"select 1\")\n>       assert actual_error_body in caplog.text\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/db/test_cursor.py:591: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:408: in text\n    return _remove_ansi_escape_sequences(self.handler.stream.getvalue())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:388: in handler\n    return self._item.stash[caplog_handler_key]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.stash.Stash object at 0x7f2c329e7100>\nkey = <_pytest.stash.StashKey object at 0x7f2c34d41280>\n\n    def __getitem__(self, key: StashKey[T]) -> T:\n        \"\"\"Get the value for key.\n    \n        Raises ``KeyError`` if the key wasn't set before.\n        \"\"\"\n>       return cast(T, self._storage[key])\nE       KeyError: <_pytest.stash.StashKey object at 0x7f2c34d41280>\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/stash.py:80: KeyError","steps":[],"attachments":[{"uid":"50bd9de73375e08e","name":"log","source":"50bd9de73375e08e.txt","type":"text/plain","size":87}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"global_fake_fs::0","time":{"start":1730776005221,"stop":1730776005221,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.unit.db"},{"name":"suite","value":"test_cursor"},{"name":"host","value":"fv-az2036-240"},{"name":"thread","value":"2074-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.unit.db.test_cursor"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":55,"skipped":0,"passed":58,"unknown":0,"total":113},"items":[{"uid":"2d9cef4f31af4784","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/345//#testresult/2d9cef4f31af4784","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f2b8d3ff2e0>","time":{"start":1730690076958,"stop":1730690076962,"duration":4}},{"uid":"f90864be6320c9ae","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/348//#testresult/f90864be6320c9ae","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f574bd3e300>","time":{"start":1730689926600,"stop":1730689926602,"duration":2}},{"uid":"4408785c7cfe8454","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/344//#testresult/4408785c7cfe8454","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f1643b3f2a0>","time":{"start":1730603672279,"stop":1730603672282,"duration":3}},{"uid":"2267d360cff73e4b","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/347//#testresult/2267d360cff73e4b","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fba6013e2e0>","time":{"start":1730603544631,"stop":1730603544634,"duration":3}},{"uid":"4096cedb8291dded","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/343//#testresult/4096cedb8291dded","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fbe87b3f300>","time":{"start":1730517014283,"stop":1730517014286,"duration":3}},{"uid":"b1275859c1903790","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/346//#testresult/b1275859c1903790","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fd72c4ff2e0>","time":{"start":1730516869503,"stop":1730516869506,"duration":3}},{"uid":"d5eb82eba7527ea1","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/342//#testresult/d5eb82eba7527ea1","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f9230cb52c0>","time":{"start":1730431112841,"stop":1730431112843,"duration":2}},{"uid":"8132b89cf02c9c64","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/345//#testresult/8132b89cf02c9c64","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7efd68bff2c0>","time":{"start":1730430943834,"stop":1730430943836,"duration":2}},{"uid":"cc737be1fdd3ac23","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/341//#testresult/cc737be1fdd3ac23","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fe2162932c0>","time":{"start":1730344386835,"stop":1730344386838,"duration":3}},{"uid":"f5cc0b85efd71088","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/344//#testresult/f5cc0b85efd71088","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f2422b3f2c0>","time":{"start":1730344256458,"stop":1730344256460,"duration":2}},{"uid":"a04b25726e28a155","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/340//#testresult/a04b25726e28a155","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f3943f41280>","time":{"start":1730257938710,"stop":1730257938712,"duration":2}},{"uid":"94399a68dd1f5bd6","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/343//#testresult/94399a68dd1f5bd6","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7effc6dbf320>","time":{"start":1730257802519,"stop":1730257802522,"duration":3}},{"uid":"2c3a9b160d93ce8f","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/339//#testresult/2c3a9b160d93ce8f","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f3a1e9ff2e0>","time":{"start":1730171567787,"stop":1730171567790,"duration":3}},{"uid":"c5d7bf29a4f6265","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/342//#testresult/c5d7bf29a4f6265","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fee002c3280>","time":{"start":1730171430855,"stop":1730171430857,"duration":2}},{"uid":"b6c636688fc2cd1f","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/338//#testresult/b6c636688fc2cd1f","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f257f67f2c0>","time":{"start":1730085303789,"stop":1730085303792,"duration":3}},{"uid":"a266b5f1c7ae48bb","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/341//#testresult/a266b5f1c7ae48bb","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7ff113ccf2c0>","time":{"start":1730085149423,"stop":1730085149426,"duration":3}},{"uid":"9d791b42982e64a0","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/337//#testresult/9d791b42982e64a0","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f305cf3f340>","time":{"start":1729998849643,"stop":1729998849646,"duration":3}},{"uid":"d9a0af1958885534","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/340//#testresult/d9a0af1958885534","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7fcb0a4fe2c0>","time":{"start":1729998720130,"stop":1729998720133,"duration":3}},{"uid":"8d1bf32d7a13524e","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/336//#testresult/8d1bf32d7a13524e","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f0181fff2a0>","time":{"start":1729912156989,"stop":1729912156991,"duration":2}},{"uid":"3e898773798d9454","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/339//#testresult/3e898773798d9454","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f61fd1ff2c0>","time":{"start":1729912018695,"stop":1729912018698,"duration":3}}]},"tags":[]},"source":"efb49cb1d6b7db77.json","parameterValues":[]}
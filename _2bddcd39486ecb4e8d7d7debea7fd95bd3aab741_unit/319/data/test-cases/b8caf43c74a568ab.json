{"uid":"b8caf43c74a568ab","name":"test_cursor_unknown_error_body_logging","fullName":"tests.unit.db.test_cursor#test_cursor_unknown_error_body_logging","historyId":"9e9db9d6284af6f68416158c85e8fb70","time":{"start":1728443454313,"stop":1728443454315,"duration":2},"status":"broken","statusMessage":"KeyError: <_pytest.stash.StashKey object at 0x7f296d6fe2e0>","statusTrace":"httpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f2969e75670>\ncursor = <firebolt.db.cursor.CursorV2 object at 0x7f2969f7beb0>\ncaplog = <_pytest.logging.LogCaptureFixture object at 0x7f296a5cdfd0>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\n\n    def test_cursor_unknown_error_body_logging(\n        httpx_mock: HTTPXMock, cursor: Cursor, caplog: LogCaptureFixture, query_url: str\n    ):\n        actual_error_body = \"Your query was incorrect\"\n        httpx_mock.add_callback(\n            lambda *args, **kwargs: Response(\n                status_code=codes.NOT_IMPLEMENTED, content=actual_error_body\n            ),\n            url=query_url,\n        )\n        with raises(HTTPStatusError):\n            cursor.execute(\"select 1\")\n>       assert actual_error_body in caplog.text\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/db/test_cursor.py:591: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:408: in text\n    return _remove_ansi_escape_sequences(self.handler.stream.getvalue())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:388: in handler\n    return self._item.stash[caplog_handler_key]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.stash.Stash object at 0x7f296a739a00>\nkey = <_pytest.stash.StashKey object at 0x7f296d6fe2e0>\n\n    def __getitem__(self, key: StashKey[T]) -> T:\n        \"\"\"Get the value for key.\n    \n        Raises ``KeyError`` if the key wasn't set before.\n        \"\"\"\n>       return cast(T, self._storage[key])\nE       KeyError: <_pytest.stash.StashKey object at 0x7f296d6fe2e0>\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/stash.py:80: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"clear_cache","time":{"start":1728443454044,"stop":1728443454044,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"global_fake_fs","time":{"start":1728443454044,"stop":1728443454049,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"KeyError: <_pytest.stash.StashKey object at 0x7f296d6fe2e0>","statusTrace":"httpx_mock = <pytest_httpx._httpx_mock.HTTPXMock object at 0x7f2969e75670>\ncursor = <firebolt.db.cursor.CursorV2 object at 0x7f2969f7beb0>\ncaplog = <_pytest.logging.LogCaptureFixture object at 0x7f296a5cdfd0>\nquery_url = URL('https://mock_engine_name.mock.firebolt.io/?output_format=JSON_Compact&database=database')\n\n    def test_cursor_unknown_error_body_logging(\n        httpx_mock: HTTPXMock, cursor: Cursor, caplog: LogCaptureFixture, query_url: str\n    ):\n        actual_error_body = \"Your query was incorrect\"\n        httpx_mock.add_callback(\n            lambda *args, **kwargs: Response(\n                status_code=codes.NOT_IMPLEMENTED, content=actual_error_body\n            ),\n            url=query_url,\n        )\n        with raises(HTTPStatusError):\n            cursor.execute(\"select 1\")\n>       assert actual_error_body in caplog.text\n\n/home/runner/work/firebolt-python-sdk/firebolt-python-sdk/tests/unit/db/test_cursor.py:591: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:408: in text\n    return _remove_ansi_escape_sequences(self.handler.stream.getvalue())\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/logging.py:388: in handler\n    return self._item.stash[caplog_handler_key]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.stash.Stash object at 0x7f296a739a00>\nkey = <_pytest.stash.StashKey object at 0x7f296d6fe2e0>\n\n    def __getitem__(self, key: StashKey[T]) -> T:\n        \"\"\"Get the value for key.\n    \n        Raises ``KeyError`` if the key wasn't set before.\n        \"\"\"\n>       return cast(T, self._storage[key])\nE       KeyError: <_pytest.stash.StashKey object at 0x7f296d6fe2e0>\n\n/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/stash.py:80: KeyError","steps":[],"attachments":[{"uid":"88c68a2850dbb699","name":"log","source":"88c68a2850dbb699.txt","type":"text/plain","size":87}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"global_fake_fs::0","time":{"start":1728443454448,"stop":1728443454449,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.unit.db"},{"name":"suite","value":"test_cursor"},{"name":"host","value":"fv-az1432-833"},{"name":"thread","value":"2274-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.unit.db.test_cursor"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":58,"unknown":0,"total":60},"items":[{"uid":"66eee237d1bb6604","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/322//#testresult/66eee237d1bb6604","status":"broken","statusDetails":"KeyError: <_pytest.stash.StashKey object at 0x7f4e68c81280>","time":{"start":1728443322452,"stop":1728443322454,"duration":2}},{"uid":"f0ca29c5db012f1","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/318//#testresult/f0ca29c5db012f1","status":"passed","time":{"start":1728357117938,"stop":1728357117940,"duration":2}},{"uid":"46bfac7e9e49ee8b","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/321//#testresult/46bfac7e9e49ee8b","status":"passed","time":{"start":1728356984615,"stop":1728356984618,"duration":3}},{"uid":"2f690b920f6ee9bd","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/317//#testresult/2f690b920f6ee9bd","status":"passed","time":{"start":1728270723701,"stop":1728270723703,"duration":2}},{"uid":"ee52fb651e2af307","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/320//#testresult/ee52fb651e2af307","status":"passed","time":{"start":1728270622581,"stop":1728270622583,"duration":2}},{"uid":"2bcf5972bc926b28","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/316//#testresult/2bcf5972bc926b28","status":"passed","time":{"start":1728184351734,"stop":1728184351736,"duration":2}},{"uid":"93e813833a1ef1ae","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/319//#testresult/93e813833a1ef1ae","status":"passed","time":{"start":1728184217346,"stop":1728184217348,"duration":2}},{"uid":"913d8e084617eac5","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/315//#testresult/913d8e084617eac5","status":"passed","time":{"start":1728097730412,"stop":1728097730415,"duration":3}},{"uid":"4b5937a39a81092a","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/318//#testresult/4b5937a39a81092a","status":"passed","time":{"start":1728097592714,"stop":1728097592717,"duration":3}},{"uid":"7e249b824b3ea12","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/314//#testresult/7e249b824b3ea12","status":"passed","time":{"start":1728011399898,"stop":1728011399900,"duration":2}},{"uid":"c058836a84f68dae","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/317//#testresult/c058836a84f68dae","status":"passed","time":{"start":1728011259482,"stop":1728011259484,"duration":2}},{"uid":"7f1f7feb5f6d97b0","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/313//#testresult/7f1f7feb5f6d97b0","status":"passed","time":{"start":1727924994627,"stop":1727924994630,"duration":3}},{"uid":"660a3b732ac9b0e7","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/316//#testresult/660a3b732ac9b0e7","status":"passed","time":{"start":1727924865065,"stop":1727924865067,"duration":2}},{"uid":"2b8dea59b7f623e6","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/312//#testresult/2b8dea59b7f623e6","status":"passed","time":{"start":1727838556299,"stop":1727838556302,"duration":3}},{"uid":"1f9ce261441653c4","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/315//#testresult/1f9ce261441653c4","status":"passed","time":{"start":1727838421089,"stop":1727838421091,"duration":2}},{"uid":"7690ea6ee9396e8d","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/311//#testresult/7690ea6ee9396e8d","status":"passed","time":{"start":1727752597408,"stop":1727752597411,"duration":3}},{"uid":"f50cae972477361","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/314//#testresult/f50cae972477361","status":"passed","time":{"start":1727752439255,"stop":1727752439257,"duration":2}},{"uid":"7a832d2586752e97","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/310//#testresult/7a832d2586752e97","status":"passed","time":{"start":1727666035543,"stop":1727666035545,"duration":2}},{"uid":"1b8990272eb95a19","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/313//#testresult/1b8990272eb95a19","status":"passed","time":{"start":1727665899073,"stop":1727665899075,"duration":2}},{"uid":"4ac25be0676a3fb6","reportUrl":"https://firebolt-db.github.io/firebolt-python-sdk/_2bddcd39486ecb4e8d7d7debea7fd95bd3aab741_unit/309//#testresult/4ac25be0676a3fb6","status":"passed","time":{"start":1727579585753,"stop":1727579585755,"duration":2}}]},"tags":[]},"source":"b8caf43c74a568ab.json","parameterValues":[]}
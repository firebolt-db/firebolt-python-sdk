{"uid":"6f4eed13d07380f5","name":"test_query_timeout[core]","fullName":"tests.integration.dbapi.sync.V2.test_timeout#test_query_timeout","historyId":"4bb6e31871c52ca2a9d26233d457d101","time":{"start":1753785395969,"stop":1753785395973,"duration":4},"status":"broken","statusMessage":"firebolt.utils.exception.FireboltStructuredError: - Line 1, Column 44: syntax error, unexpected invalid token, expecting '['\nSELECT checksum(*) FROM GENERATE_SERIES(1, {long_value})\n                                           ^ at {'failing_line': 1, 'start_offset': 44}","statusTrace":"connection = <firebolt.db.connection.Connection object at 0x7f7eb00b0a50>\n\n    def test_query_timeout(connection: Connection):\n        with connection.cursor() as cursor:\n            with raises(QueryTimeoutError):\n>               cursor.execute(LONG_SELECT, timeout_seconds=1)\n\ntests/integration/dbapi/sync/V2/test_timeout.py:12: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/firebolt/common/cursor/decorators.py:24: in inner\n    return func(self, *args, **kwargs)\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/firebolt/db/cursor.py:377: in execute\n    self._do_execute(query, params_list, skip_parsing, timeout=timeout_seconds)\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/firebolt/db/cursor.py:250: in _do_execute\n    self._execute_single_query(\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/firebolt/db/cursor.py:304: in _execute_single_query\n    self._handle_query_execution(\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/firebolt/db/cursor.py:333: in _handle_query_execution\n    self._raise_if_error(resp)\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/firebolt/db/cursor.py:121: in _raise_if_error\n    raise_error_from_response(resp)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nresp = <Response [400 Bad Request]>\n\n    def raise_error_from_response(resp: Response) -> None:\n        \"\"\"\n        Raise a correct error from the response.\n        Look for a structured error in the body and raise it.\n        If the body doesn't contain a structured error,\n        log the body and raise a status code error.\n    \n        Args:\n            resp (Response): HTTP response\n        \"\"\"\n        to_raise = None\n        try:\n            decoded = resp.json()\n            if \"errors\" in decoded and len(decoded[\"errors\"]) > 0:\n                # Raise later to avoid catching it in the except block\n                to_raise = FireboltStructuredError(decoded)\n    \n        except Exception:\n            # If we can't parse the body, print out the error body\n            if \"Content-Length\" in resp.headers and int(resp.headers[\"Content-Length\"]) > 0:\n                logger.error(f\"Something went wrong: {resp.read().decode('utf-8')}\")\n    \n        if to_raise:\n>           raise to_raise\nE           firebolt.utils.exception.FireboltStructuredError: - Line 1, Column 44: syntax error, unexpected invalid token, expecting '['\nE           SELECT checksum(*) FROM GENERATE_SERIES(1, {long_value})\nE                                                      ^ at {'failing_line': 1, 'start_offset': 44}\n\n/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/firebolt/utils/util.py:186: FireboltStructuredError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"engine_name","time":{"start":1753785392453,"stop":1753785392453,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"database_name","time":{"start":1753785392453,"stop":1753785392453,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_id","time":{"start":1753785392454,"stop":1753785392454,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"auth","time":{"start":1753785392454,"stop":1753785392520,"duration":66},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"service_secret","time":{"start":1753785392454,"stop":1753785392454,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"core_auth","time":{"start":1753785392520,"stop":1753785392521,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"account_name","time":{"start":1753785392521,"stop":1753785392521,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"core_url","time":{"start":1753785392521,"stop":1753785392521,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"api_endpoint","time":{"start":1753785392521,"stop":1753785392521,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connection","time":{"start":1753785395945,"stop":1753785395969,"duration":24},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"connection::0","time":{"start":1753785395998,"stop":1753785395998,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests.integration.dbapi.sync.V2"},{"name":"suite","value":"test_timeout"},{"name":"host","value":"pkrvmpptgkbjq6m"},{"name":"thread","value":"4325-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.dbapi.sync.V2.test_timeout"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"connection","value":"'core'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"6f4eed13d07380f5.json","parameterValues":["'core'"]}
name: Pull request

on: push

jobs:
  check-title:
    runs-on: ubuntu-latest
    steps:
      - name: Check out code
        uses: actions/checkout@v2
      
      - name: Setup auth
        run: |
          mkdir -p ~/.firebolt/dev-cli/
          echo "account_id = \"${{ secrets.TEMP_ACCOUNT_ID }}\"" > ~/.firebolt/dev-cli/dev.toml
          echo "api_url = \"https://api.dev.firebolt.io\"" >> ~/.firebolt/dev-cli/dev.toml
          echo "email = \"${{ secrets.TEMP_USERNAME }}\"" >> ~/.firebolt/dev-cli/dev.toml
          echo "password = \"${{ secrets.TEMP_PASSWORD }}\"" >> ~/.firebolt/dev-cli/dev.toml
          echo "\n[token]" >> ~/.firebolt/dev-cli/dev.toml
          echo "access_token = \"dummy\"" >> ~/.firebolt/dev-cli/dev.toml
          echo "expiry = \"2022-09-22T02:48:02+01:00\"" >> ~/.firebolt/dev-cli/dev.toml # making sure to keep it in the past
          echo "refresh_token = \"\"" >> ~/.firebolt/dev-cli/dev.toml
          
          touch ~/.firebolt/dev-cli/config.toml
      
      - name: run
        run: |
          chmod +x dev_cli_linux_amd64
          ./dev_cli_linux_amd64 drop petro_to_drop --skip_latest
